'use client'

import { useSession } from 'next-auth/react'
import { useRouter } from 'next/navigation'

import React, { useState, useEffect } from 'react'
import { Badge } from '@/components/ui/badge'
import { Button } from '@/components/ui/button'
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'
import { Progress } from '@/components/ui/progress'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'
import { 
  Star, 
  TrendingUp, 
  DollarSign, 
  Target,
  Users,
  BarChart3,
  Heart,
  Share2,
  Activity,
  MessageSquare,
  Search,
  UserCheck,
  FileText,
  Globe,
  Sparkles,
  ArrowUp,
  ChevronDown,
  ThumbsUp,
  ThumbsDown,
  Crown,
  CheckCircle,
  Download,
  Lightbulb,
  ArrowRight
} from 'lucide-react'
import KeywordNetwork from '@/components/KeywordNetwork'
import Link from 'next/link'
import { useAmazonSearchTerms } from '@/hooks/useAmazonSearchTerms'
import { MembershipGate } from '@/components/MembershipGate'

interface ProductPageProps {
  params: Promise<{ slug: string }>
}

// Mock data for the daily product
const dailyProductData = {
  id: 'daily_product_1',
  title: 'Smart Bluetooth Sleep Mask with Built-in Speakers',
  subtitle: 'Revolutionary sleep technology combining comfort with audio entertainment',
  category: 'Health & Personal Care',
  asin: 'B08MVBRNKV',
  date: 'July 4, 2025',
  mainImage: 'https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=800&h=600&fit=crop',
  
  // Overall scores
  opportunityScore: 87,
  scores: {
    demand: 92,
    competition: 78,
    keywords: 85,
    financial: 88,
    overall: 87
  },
  
  // Demand Analysis Data
  demandData: {
    monthlySearchVolume: 45000,
    searchTrend: '+23%',
    marketSize: 1200000000,
    marketGrowth: '+15%',
    conversionRate: 12.5,
    clickShare: 32,
    seasonality: {
      jan: 85, feb: 82, mar: 78, apr: 75, may: 70, jun: 68,
      jul: 65, aug: 70, sep: 75, oct: 80, nov: 90, dec: 100
    },
    googleTrends: [
      { month: 'Jan', value: 85 },
      { month: 'Feb', value: 82 },
      { month: 'Mar', value: 78 },
      { month: 'Apr', value: 75 },
      { month: 'May', value: 70 },
      { month: 'Jun', value: 68 },
      { month: 'Jul', value: 65 },
      { month: 'Aug', value: 70 },
      { month: 'Sep', value: 75 },
      { month: 'Oct', value: 80 },
      { month: 'Nov', value: 90 },
      { month: 'Dec', value: 100 }
    ],
    customerAvatars: [
      {
        name: 'Night Shift Worker',
        age: '25-40',
        pain: 'Difficulty sleeping during the day',
        motivation: 'Block out light and noise while sleeping'
      },
      {
        name: 'Meditation Enthusiast',
        age: '30-55',
        pain: 'Distractions during meditation',
        motivation: 'Enhanced focus with guided audio'
      },
      {
        name: 'Frequent Traveler',
        age: '28-45',
        pain: 'Poor sleep on planes and in hotels',
        motivation: 'Portable comfort and entertainment'
      }
    ],
    socialSignals: {
      tiktok: { posts: 2341, views: 4500000, engagement: '8.2%' },
      instagram: { posts: 5678, engagement: '6.5%' },
      youtube: { videos: 892, avgViews: 45000 },
      reddit: { discussions: 234, sentiment: 'positive' }
    }
  },

  // Competition Analysis Data
  competitionData: {
    totalCompetitors: 127,
    topCompetitors: [
      {
        rank: 1,
        name: 'MUSICOZY Sleep Headphones',
        asin: 'B07SHBQY7Z',
        price: 29.99,
        rating: 4.3,
        reviews: 15234,
        monthlyRevenue: 456000,
        monthlyClicks: 45600,
        monthlyOrders: 15234,
        conversionRate: 12.5,
        aov: 29.99,
        keywordStrength: 23.5,
        mainImage: 'https://images.unsplash.com/photo-1559563458-527698bf5295?w=200&h=200&fit=crop',
        images: [
          'https://images.unsplash.com/photo-1559563458-527698bf5295?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop'
        ],
        dominance: 23.5,
        listing: {
          title: 'MUSICOZY Sleep Headphones Bluetooth Headband, Soft Sleeping Wireless Music Sport Headbands, Long Time Play Sleeping Headphones for Side Sleepers',
          bulletPoints: [
            'Premium Sound Quality - Advanced Bluetooth 5.0 technology ensures crystal clear audio',
            'Ultra-Comfortable Design - Made with breathable, moisture-wicking fabric',
            'Long Battery Life - Up to 10 hours of continuous playback',
            'Perfect for Side Sleepers - Thin speakers won\'t cause discomfort',
            'Washable & Durable - Machine washable design for easy maintenance'
          ],
          keywords: ['sleep headphones', 'bluetooth headband', 'wireless music', 'side sleepers'],
          description: 'Experience the ultimate in sleep comfort with our premium Bluetooth sleep headphones...'
        }
      },
      {
        rank: 2,
        name: 'Perytong Sleep Headphones',
        asin: 'B07Q34GWQT',
        price: 25.99,
        rating: 4.1,
        reviews: 12456,
        monthlyRevenue: 324000,
        monthlyClicks: 32400,
        monthlyOrders: 12456,
        conversionRate: 11.8,
        aov: 25.99,
        keywordStrength: 18.2,
        mainImage: 'https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=200&h=200&fit=crop',
        images: [
          'https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1559563458-527698bf5295?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400&h=400&fit=crop'
        ],
        dominance: 18.2,
        listing: {
          title: 'Perytong Sleep Headphones Bluetooth Sports Headband Thin Speakers Perfect for Workout, Jogging, Yoga, Insomnia, Side Sleepers',
          bulletPoints: [
            'Thin Speakers Design - Ultra-thin speakers for maximum comfort during sleep',
            'Bluetooth 5.0 Technology - Stable connection with all Bluetooth devices',
            'Sports & Sleep Dual Use - Perfect for both workouts and sleep',
            'Soft Elastic Headband - One size fits all comfortable design',
            'Easy Controls - Simple button controls for music and calls'
          ],
          keywords: ['sleep headphones', 'sports headband', 'bluetooth speakers', 'workout headphones'],
          description: 'Discover the perfect combination of comfort and functionality with our versatile sleep headphones...'
        }
      },
      {
        rank: 3,
        name: 'CozyPhones Sleep Headphones',
        asin: 'B00MFQJK1G',
        price: 19.95,
        rating: 4.0,
        reviews: 8934,
        monthlyRevenue: 178000,
        monthlyClicks: 23400,
        monthlyOrders: 8934,
        conversionRate: 10.2,
        aov: 19.95,
        keywordStrength: 12.8,
        mainImage: 'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=200&h=200&fit=crop',
        images: [
          'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop'
        ],
        dominance: 12.8,
        listing: {
          title: 'CozyPhones Sleep Headphones & Travel Bag - Soft Braided Cord - Noise Isolating Earbuds Ideal for Side Sleepers',
          bulletPoints: [
            'Patented Design - Unique flat speaker design for side sleepers',
            'Noise Isolation - Block out ambient noise for better sleep',
            'Durable Braided Cord - Tangle-free braided cord construction',
            'Travel Ready - Includes premium travel bag',
            'Hypoallergenic Materials - Safe for sensitive skin'
          ],
          keywords: ['sleep headphones', 'side sleepers', 'noise isolation', 'travel headphones'],
          description: 'Transform your sleep experience with our patented flat speaker design headphones...'
        }
      }
    ],
    priceDistribution: [
      { range: '$0-20', count: 34, percentage: 26.8 },
      { range: '$20-30', count: 52, percentage: 40.9 },
      { range: '$30-40', count: 28, percentage: 22.0 },
      { range: '$40+', count: 13, percentage: 10.2 }
    ],
    averageRating: 4.2,
    averageReviews: 3421,
    averagePrice: 27.99
  },
  
  // Keywords Analysis Data
  keywordsData: {
    primaryKeyword: 'bluetooth sleep mask',
    cpc: 1.23,
    competition: 'Medium',
    keywordHierarchy: {
      'Sleep Technology': {
        totalRevenue: 298000,
        totalOrders: 1420,
        avgConversionRate: 12.1,
        avgCPC: 1.12,
        subroots: {
          'Bluetooth Keywords': {
            totalRevenue: 145000,
            totalOrders: 600,
            avgConversionRate: 12.5,
            avgCPC: 1.23,
            keywords: [
              { keyword: 'bluetooth sleep mask', monthlyRevenue: 89000, monthlyOrders: 380, conversionRate: 12.5, aov: 29.99, cpc: 1.23, difficulty: 68 },
              { keyword: 'bluetooth sleep headphones', monthlyRevenue: 34000, monthlyOrders: 140, conversionRate: 11.8, aov: 28.50, cpc: 1.15, difficulty: 65 },
              { keyword: 'bluetooth headband sleep', monthlyRevenue: 22000, monthlyOrders: 80, conversionRate: 13.2, aov: 27.50, cpc: 1.35, difficulty: 72 }
            ]
          },
          'Wireless Keywords': {
            totalRevenue: 89000,
            totalOrders: 380,
            avgConversionRate: 11.9,
            avgCPC: 1.08,
            keywords: [
              { keyword: 'wireless sleep mask', monthlyRevenue: 45000, monthlyOrders: 200, conversionRate: 11.9, aov: 28.50, cpc: 1.15, difficulty: 62 },
              { keyword: 'wireless sleep headphones', monthlyRevenue: 28000, monthlyOrders: 120, conversionRate: 12.1, aov: 26.99, cpc: 1.05, difficulty: 58 },
              { keyword: 'wireless headband sleep', monthlyRevenue: 16000, monthlyOrders: 60, conversionRate: 11.5, aov: 25.99, cpc: 1.02, difficulty: 55 }
            ]
          },
          'Smart Keywords': {
            totalRevenue: 64000,
            totalOrders: 290,
            avgConversionRate: 11.8,
            avgCPC: 0.98,
            keywords: [
              { keyword: 'smart sleep mask', monthlyRevenue: 32000, monthlyOrders: 140, conversionRate: 11.8, aov: 24.99, cpc: 0.98, difficulty: 60 },
              { keyword: 'smart sleep headphones', monthlyRevenue: 19000, monthlyOrders: 85, conversionRate: 12.0, aov: 23.99, cpc: 0.95, difficulty: 58 },
              { keyword: 'smart headband sleep', monthlyRevenue: 13000, monthlyOrders: 65, conversionRate: 11.5, aov: 22.99, cpc: 1.02, difficulty: 52 }
            ]
          }
        }
      },
      'Sleep Comfort': {
        totalRevenue: 156000,
        totalOrders: 720,
        avgConversionRate: 10.8,
        avgCPC: 0.89,
        subroots: {
          'Side Sleeper Keywords': {
            totalRevenue: 89000,
            totalOrders: 420,
            avgConversionRate: 11.2,
            avgCPC: 0.92,
            keywords: [
              { keyword: 'sleep mask side sleepers', monthlyRevenue: 45000, monthlyOrders: 220, conversionRate: 11.5, aov: 24.99, cpc: 0.95, difficulty: 48 },
              { keyword: 'headphones side sleepers', monthlyRevenue: 28000, monthlyOrders: 130, conversionRate: 11.0, aov: 23.99, cpc: 0.88, difficulty: 45 },
              { keyword: 'sleep headband side sleepers', monthlyRevenue: 16000, monthlyOrders: 70, conversionRate: 10.8, aov: 22.99, cpc: 0.92, difficulty: 42 }
            ]
          },
          'Comfort Keywords': {
            totalRevenue: 67000,
            totalOrders: 300,
            avgConversionRate: 10.4,
            avgCPC: 0.85,
            keywords: [
              { keyword: 'comfortable sleep mask', monthlyRevenue: 34000, monthlyOrders: 160, conversionRate: 10.8, aov: 21.99, cpc: 0.88, difficulty: 40 },
              { keyword: 'soft sleep headphones', monthlyRevenue: 21000, monthlyOrders: 95, conversionRate: 10.2, aov: 20.99, cpc: 0.82, difficulty: 38 },
              { keyword: 'comfortable sleep headband', monthlyRevenue: 12000, monthlyOrders: 45, conversionRate: 9.8, aov: 19.99, cpc: 0.85, difficulty: 35 }
            ]
          }
        }
      }
    },
    keywordClusters: {
      technology: {
        root: 'bluetooth sleep mask',
        subroots: ['bluetooth', 'wireless', 'smart'],
        keywords: ['bluetooth sleep mask', 'wireless sleep mask', 'smart sleep mask']
      }
    }
  },

  // Review Analysis Data
  reviewAnalysisData: {
    overallSentiment: 'positive',
    sentimentScore: 4.2,
    totalReviews: 36624,
    competitorReviews: [
      {
        competitor: 'MUSICOZY Sleep Headphones',
        sentiment: 'positive',
        score: 4.3,
        totalReviews: 15234,
        themes: {
          positive: ['comfortable', 'great sound quality', 'perfect for sleeping', 'good battery life'],
          negative: ['volume controls difficult', 'sizing issues for larger heads', 'connectivity problems']
        },
        keyInsights: [
          'Users love the comfort for side sleeping',
          'Sound quality consistently praised',
          'Battery life exceeds expectations',
          'Control placement could be improved'
        ]
      },
      {
        competitor: 'Perytong Sleep Headphones',
        sentiment: 'positive',
        score: 4.1,
        totalReviews: 12456,
        themes: {
          positive: ['versatile for sports and sleep', 'thin speakers', 'easy controls', 'good value'],
          negative: ['durability concerns', 'speaker positioning', 'fabric quality']
        },
        keyInsights: [
          'Dual-use appeal for sports and sleep',
          'Thin speaker design highly valued',
          'Price point considered excellent value',
          'Long-term durability questioned'
        ]
      },
      {
        competitor: 'CozyPhones Sleep Headphones',
        sentiment: 'neutral',
        score: 4.0,
        totalReviews: 8934,
        themes: {
          positive: ['unique flat design', 'travel-friendly', 'noise isolation', 'hypoallergenic'],
          negative: ['sound quality limitations', 'cord tangling', 'comfort for some users']
        },
        keyInsights: [
          'Flat speaker design differentiator',
          'Strong travel use case',
          'Noise isolation effective',
          'Sound quality trade-offs noted'
        ]
      }
    ],
    commonThemes: {
      positive: ['comfort', 'sleep quality improvement', 'sound quality', 'battery life', 'side sleeping'],
      negative: ['durability', 'sizing', 'controls', 'connectivity', 'comfort variations'],
      opportunities: ['improved controls', 'better sizing options', 'enhanced durability', 'premium materials']
    }
  },

  // Listing Optimization Data
  listingOptimizationData: {
    imageAnalysis: {
      position1: {
        commonThemes: ['product on white background', 'clean minimal style', 'headband clearly visible'],
        creativeBrief: 'Main hero shot should showcase the sleep mask on a clean white background with the Bluetooth speakers clearly visible. Focus on the comfortable headband design and premium materials. Use natural lighting to highlight texture and quality.',
        competitorImages: [
          'https://images.unsplash.com/photo-1559563458-527698bf5295?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400&h=400&fit=crop'
        ],
        optimizationTips: [
          'Ensure product takes up 85% of image space',
          'Use high contrast to highlight key features',
          'Show unique design elements clearly'
        ]
      },
      position2: {
        commonThemes: ['lifestyle usage', 'person sleeping', 'comfort demonstration'],
        creativeBrief: 'Lifestyle shot featuring a person peacefully sleeping while wearing the mask. Show side sleeping position to emphasize comfort. Use warm, cozy bedroom lighting to convey relaxation and quality sleep.',
        competitorImages: [
          'https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=400&h=400&fit=crop',
          'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400&h=400&fit=crop'
        ],
        optimizationTips: [
          'Show actual usage scenario',
          'Emphasize comfort and peaceful sleep',
          'Use diverse models to appeal to broader audience'
        ]
      },
      position3: {
        commonThemes: ['feature callouts', 'technical details', 'specifications'],
        creativeBrief: 'Detailed feature breakdown image highlighting key selling points: Bluetooth connectivity, battery life, speaker positioning, and material quality. Use infographic style with clean icons and easy-to-read text.',
        competitorImages: [
          'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop'
        ],
        optimizationTips: [
          'Keep text large and readable on mobile',
          'Highlight unique features prominently',
          'Use visual icons for quick understanding'
        ]
      },
      position4: {
        commonThemes: ['comparison charts', 'what\'s included', 'package contents'],
        creativeBrief: 'Package contents and comparison image showing what customers receive and how the product compares to alternatives. Include charging cable, instruction manual, and any accessories. Use organized grid layout.',
        competitorImages: [],
        optimizationTips: [
          'Show complete package contents',
          'Include size comparisons',
          'Highlight value proposition'
        ]
      }
    },
    titleOptimization: {
      currentPattern: 'Brand + Product Type + Key Features + Use Case',
      recommendations: [
        'Include "Bluetooth" early in title for algorithm relevance',
        'Mention "Side Sleepers" as key differentiator',
        'Add "Wireless" for additional keyword coverage',
        'Keep under 200 characters for mobile display'
      ],
      suggestedTitle: 'Premium Bluetooth Sleep Mask with Built-in Speakers - Wireless Audio Headband for Side Sleepers, Meditation & Travel'
    },
    bulletPointOptimization: {
      structure: 'Benefit + Feature + Proof Point',
      recommendations: [
        'Lead with primary customer benefit',
        'Include technical specifications',
        'Address common pain points from reviews',
        'Use power words and emotional triggers'
      ]
    }
  },

  // Financial Data
  financialData: {
    avgSellingPrice: 29.99,
    totalFees: 8.50,
    monthlyProjections: {
      revenue: 52000,
      profit: 18200,
      units: 1735
    },
    monthlyOrders: 1735,
    monthlyClicks: 13880,
    avgConversionRate: 12.5,
    keywordDepthGrade: 'A-',
    annualizedRevenue: 624000,
    annualizedProfit: 218400,
    priceAnalysis: {
      currentPosition: {
        price: 29.99,
        salesRank: 12340,
        percentile: 65
      },
      pricePoints: [
        { price: 15.99, salesRank: 89000, monthlyUnits: 450, revenue: 7195, percentile: 15 },
        { price: 19.99, salesRank: 45000, monthlyUnits: 820, revenue: 16392, percentile: 30 },
        { price: 24.99, salesRank: 23000, monthlyUnits: 1240, revenue: 30988, percentile: 50 },
        { price: 29.99, salesRank: 12340, monthlyUnits: 1735, revenue: 52038, percentile: 65 },
        { price: 34.99, salesRank: 7800, monthlyUnits: 1980, revenue: 69242, percentile: 75 },
        { price: 39.99, salesRank: 5200, monthlyUnits: 2100, revenue: 83979, percentile: 85 },
        { price: 44.99, salesRank: 3500, monthlyUnits: 1890, revenue: 85011, percentile: 90 },
        { price: 49.99, salesRank: 2800, monthlyUnits: 1620, revenue: 80988, percentile: 95 }
      ],
      optimalRange: {
        min: 34.99,
        max: 39.99,
        reason: 'Sweet spot for maximum revenue with strong sales rank'
      },
      competitorPricing: [
        { name: 'MUSICOZY', price: 29.99, salesRank: 12340, position: 'competitive' },
        { name: 'Perytong', price: 25.99, salesRank: 18500, position: 'value' },
        { name: 'CozyPhones', price: 19.95, salesRank: 35600, position: 'budget' }
      ]
    }
  }
}

// Generate sample keyword metrics for demonstration
const generateKeywordMetrics = (baseVolume: number) => {
  const monthlyClicks = Math.round(baseVolume * 0.8)
  const conversionRate = (2.5 + Math.random() * 5).toFixed(1)
  const monthlyOrders = Math.round(monthlyClicks * (parseFloat(conversionRate) / 100))
  const avgOrderValue = 28.99
  const monthlyRevenue = monthlyOrders * avgOrderValue
  return { monthlyClicks, conversionRate, monthlyOrders, monthlyRevenue }
}

// Keyword Pivot Table Component
const KeywordPivotTable = ({ keywordHierarchy }: { keywordHierarchy: any }) => {
  const [expandedRoots, setExpandedRoots] = useState<Set<string>>(new Set())
  const [expandedSubroots, setExpandedSubroots] = useState<Set<string>>(new Set())

  const toggleRoot = (rootName: string) => {
    const newExpanded = new Set(expandedRoots)
    if (newExpanded.has(rootName)) {
      newExpanded.delete(rootName)
      // Also collapse all subroots under this root
      const newExpandedSubroots = new Set(expandedSubroots)
      Object.keys(keywordHierarchy[rootName].subroots).forEach(subroot => {
        newExpandedSubroots.delete(`${rootName}-${subroot}`)
      })
      setExpandedSubroots(newExpandedSubroots)
    } else {
      newExpanded.add(rootName)
    }
    setExpandedRoots(newExpanded)
  }

  const toggleSubroot = (rootName: string, subrootName: string) => {
    const key = `${rootName}-${subrootName}`
    const newExpanded = new Set(expandedSubroots)
    if (newExpanded.has(key)) {
      newExpanded.delete(key)
    } else {
      newExpanded.add(key)
    }
    setExpandedSubroots(newExpanded)
  }

  return (
    <div className="overflow-x-auto">
      <table className="min-w-full">
        <thead className="bg-gray-50">
          <tr>
            <th className="text-left py-3 px-6 font-medium text-gray-900">Keyword Group</th>
            <th className="text-left py-3 px-4 font-medium text-gray-900">Monthly Revenue</th>
            <th className="text-left py-3 px-4 font-medium text-gray-900">Monthly Orders</th>
            <th className="text-left py-3 px-4 font-medium text-gray-900">Conv. Rate</th>
            <th className="text-left py-3 px-4 font-medium text-gray-900">Avg CPC</th>
            <th className="text-left py-3 px-4 font-medium text-gray-900">Difficulty</th>
          </tr>
        </thead>
        <tbody>
          {Object.entries(keywordHierarchy).map(([rootName, rootData]: [string, any]) => (
            <React.Fragment key={rootName}>
              {/* Root Level */}
              <tr className="border-b bg-blue-50 hover:bg-blue-100 cursor-pointer" onClick={() => toggleRoot(rootName)}>
                <td className="py-3 px-6">
                  <div className="flex items-center">
                    <div className="mr-2">
                      {expandedRoots.has(rootName) ? (
                        <ChevronDown className="h-4 w-4 text-gray-600" />
                      ) : (
                        <ArrowRight className="h-4 w-4 text-gray-600" />
                      )}
                    </div>
                    <span className="font-semibold text-gray-900">{rootName}</span>
                  </div>
                </td>
                <td className="py-3 px-4">
                  <span className="font-semibold text-green-600">${rootData.totalRevenue.toLocaleString()}</span>
                </td>
                <td className="py-3 px-4">
                  <span className="font-medium">{rootData.totalOrders.toLocaleString()}</span>
                </td>
                <td className="py-3 px-4">
                  <span className="font-medium">{rootData.avgConversionRate}%</span>
                </td>
                <td className="py-3 px-4">
                  <span className="font-medium">${rootData.avgCPC}</span>
                </td>
                <td className="py-3 px-4">
                  <span className="text-gray-500">-</span>
                </td>
              </tr>

              {/* Subroot Level */}
              {expandedRoots.has(rootName) && Object.entries(rootData.subroots).map(([subrootName, subrootData]: [string, any]) => (
                <React.Fragment key={`${rootName}-${subrootName}`}>
                  <tr className="border-b bg-green-50 hover:bg-green-100 cursor-pointer" onClick={() => toggleSubroot(rootName, subrootName)}>
                    <td className="py-3 px-6">
                      <div className="flex items-center">
                        <div className="ml-6 mr-2">
                          {expandedSubroots.has(`${rootName}-${subrootName}`) ? (
                            <ChevronDown className="h-4 w-4 text-gray-600" />
                          ) : (
                            <ArrowRight className="h-4 w-4 text-gray-600" />
                          )}
                        </div>
                        <span className="font-medium text-gray-800">{subrootName}</span>
                      </div>
                    </td>
                    <td className="py-3 px-4">
                      <span className="font-medium text-green-600">${subrootData.totalRevenue.toLocaleString()}</span>
                    </td>
                    <td className="py-3 px-4">
                      <span className="font-medium">{subrootData.totalOrders.toLocaleString()}</span>
                    </td>
                    <td className="py-3 px-4">
                      <span className="font-medium">{subrootData.avgConversionRate}%</span>
                    </td>
                    <td className="py-3 px-4">
                      <span className="font-medium">${subrootData.avgCPC}</span>
                    </td>
                    <td className="py-3 px-4">
                      <span className="text-gray-500">-</span>
                    </td>
                  </tr>

                  {/* Leaf Keywords */}
                  {expandedSubroots.has(`${rootName}-${subrootName}`) && subrootData.keywords.map((keyword: any, index: number) => (
                    <tr key={`${rootName}-${subrootName}-${index}`} className="border-b hover:bg-gray-50">
                      <td className="py-3 px-6">
                        <div className="ml-12">
                          <span className="text-gray-700">{keyword.keyword}</span>
                        </div>
                      </td>
                      <td className="py-3 px-4">
                        <span className="text-green-600">${keyword.monthlyRevenue.toLocaleString()}</span>
                      </td>
                      <td className="py-3 px-4">
                        <span className="text-gray-700">{keyword.monthlyOrders.toLocaleString()}</span>
                      </td>
                      <td className="py-3 px-4">
                        <span className="text-gray-700">{keyword.conversionRate}%</span>
                      </td>
                      <td className="py-3 px-4">
                        <span className="text-gray-700">${keyword.cpc}</span>
                      </td>
                      <td className="py-3 px-4">
                        <div className="flex items-center">
                          <div className="w-12 bg-gray-200 rounded-full h-2 mr-2">
                            <div 
                              className={`h-2 rounded-full ${keyword.difficulty >= 70 ? 'bg-red-500' : keyword.difficulty >= 40 ? 'bg-yellow-500' : 'bg-green-500'}`}
                              style={{ width: `${keyword.difficulty}%` }}
                            ></div>
                          </div>
                          <span className="text-xs text-gray-600">{keyword.difficulty}%</span>
                        </div>
                      </td>
                    </tr>
                  ))}
                </React.Fragment>
              ))}
            </React.Fragment>
          ))}
        </tbody>
      </table>
    </div>
  )
}

export default function ProductPage({ params }: ProductPageProps) {
  const { data: session, status } = useSession()
  const router = useRouter()
  const [loading, setLoading] = useState(true)
  const [slug, setSlug] = useState<string>('')
  const [cogsPercentage, setCogsPercentage] = useState(25)
  const [showScrollTop, setShowScrollTop] = useState(false)
  const [userRating, setUserRating] = useState<number | null>(null)
  const [isClaimHovered, setIsClaimHovered] = useState(false)
  const [isSaved, setIsSaved] = useState(false)
  const [isSharing, setIsSharing] = useState(false)
  const [activeTab, setActiveTab] = useState('demand')
  
  // Get main keywords for Google Trends
  const mainKeywords = [
    'bluetooth sleep mask',
    'sleep headphones',
    'sleep mask with speakers',
    'wireless sleep mask',
    'sleeping headphones'
  ]
  
  // Fetch Amazon Search Terms data
  const { data: searchTermsData, loading: searchTermsLoading, error: searchTermsError } = useAmazonSearchTerms(mainKeywords, 4, !loading)

  useEffect(() => {
    const loadData = async () => {
      const resolvedParams = await params
      setSlug(resolvedParams.slug)
      // Simulate loading delay
      setTimeout(() => setLoading(false), 500)
    }

    loadData()
  }, [params])

  useEffect(() => {
    const handleScroll = () => {
      setShowScrollTop(window.scrollY > 400)
    }

    window.addEventListener('scroll', handleScroll)
    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' })
  }

  const handleSaveAnalysis = async () => {
    if (isSaved) return
    
    try {
      // In a real app, this would save to user's account
      await new Promise(resolve => setTimeout(resolve, 1000))
      setIsSaved(true)
      
      // Show success message
      setTimeout(() => {
        alert('Analysis saved to your account!')
      }, 100)
    } catch (error) {
      alert('Failed to save analysis. Please try again.')
    }
  }

  const handleShareReport = async () => {
    setIsSharing(true)
    try {
      if (navigator.share) {
        await navigator.share({
          title: dailyProductData.title,
          text: `Check out this Amazon product opportunity with a ${dailyProductData.opportunityScore} opportunity score!`,
          url: window.location.href
        })
      } else {
        // Fallback: copy to clipboard
        await navigator.clipboard.writeText(window.location.href)
        alert('Link copied to clipboard!')
      }
    } catch (error) {
      // Fallback for older browsers
      const textarea = document.createElement('textarea')
      textarea.value = window.location.href
      document.body.appendChild(textarea)
      textarea.select()
      document.execCommand('copy')
      document.body.removeChild(textarea)
      alert('Link copied to clipboard!')
    } finally {
      setIsSharing(false)
    }
  }


  const getScoreColor = (score: number) => {
    if (score >= 85) return 'text-green-600'
    if (score >= 70) return 'text-yellow-600'
    return 'text-red-600'
  }

  const getScoreBgColor = (score: number) => {
    if (score >= 85) return 'bg-green-50 border-green-200'
    if (score >= 70) return 'bg-yellow-50 border-yellow-200'
    return 'bg-red-50 border-red-200'
  }

  const getScoreLabel = (score: number) => {
    if (score >= 90) return 'Excellent'
    if (score >= 80) return 'Very Good'
    if (score >= 70) return 'Good'
    if (score >= 60) return 'Fair'
    return 'Poor'
  }

  // Calculate financial metrics based on COGS percentage
  const calculateFinancials = () => {
    const sellingPrice = dailyProductData.financialData.avgSellingPrice
    const cogs = sellingPrice * (cogsPercentage / 100)
    const amazonFees = dailyProductData.financialData.totalFees
    const ppcCost = 3.20 // avg per unit
    const netProfit = sellingPrice - cogs - amazonFees - ppcCost
    const profitMargin = (netProfit / sellingPrice) * 100
    
    return {
      cogs: cogs.toFixed(2),
      netProfit: netProfit.toFixed(2),
      profitMargin: profitMargin.toFixed(1)
    }
  }

  // Calculate financial metrics - must be done before early returns
  const financials = calculateFinancials()

  if (loading || status === 'loading') {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
      </div>
    )
  }

  // Check if user is authenticated
  if (status === 'unauthenticated' || !session) {
    return <MembershipGate productTitle={dailyProductData.title} productImage={dailyProductData.imageUrl} />
  }

  // Check if user has appropriate subscription tier
  const userTier = session.user?.subscriptionTier || 'free'
  if (userTier === 'free') {
    return <MembershipGate productTitle={dailyProductData.title} productImage={dailyProductData.imageUrl} />
  }

  return (
    <div className="min-h-screen bg-gray-50">
      
      {/* Hero Section */}
      <div className="bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
          <div className="text-center mb-8">
            <div className="flex items-center justify-center mb-4">
              <Badge className="bg-blue-100 text-blue-800">Product of the Day</Badge>
            </div>
            <h1 className="text-4xl font-bold text-gray-900 mb-4">{dailyProductData.title}</h1>
            <p className="text-xl text-gray-600 mb-6">{dailyProductData.subtitle}</p>
            
            {/* Product Image and Opportunity Score */}
            <div className="max-w-4xl mx-auto mb-8">
              <div className="grid md:grid-cols-2 gap-8 items-center">
                {/* Product Image */}
                <div className="flex justify-center md:justify-end">
                  <div className="relative w-full max-w-sm">
                    <div className="aspect-square bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200">
                      <img
                        src={dailyProductData.imageUrl}
                        alt={dailyProductData.title}
                        className="w-full h-full object-contain p-4"
                      />
                    </div>
                  </div>
                </div>
                
                {/* Opportunity Score */}
                <div className="flex justify-center md:justify-start">
                  <div className="w-full max-w-sm">
                    <div className={`aspect-square rounded-2xl border-2 ${getScoreBgColor(dailyProductData.opportunityScore)} flex flex-col items-center justify-center p-8`}>
                      <div className={`text-8xl font-bold ${getScoreColor(dailyProductData.opportunityScore)} mb-4`}>
                        {dailyProductData.opportunityScore}
                      </div>
                      <div className="text-2xl font-semibold text-gray-900 mb-2">Opportunity Score</div>
                      <div className={`text-xl font-medium ${getScoreColor(dailyProductData.opportunityScore)}`}>
                        {getScoreLabel(dailyProductData.opportunityScore)}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Navigation Scorecards */}
            <div className="grid grid-cols-7 gap-2 mt-8 max-w-6xl mx-auto">
            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'market' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('market')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Market Intel</h3>
                <div className="text-xl font-bold text-indigo-600">A</div>
              </CardContent>
            </Card>

            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'demand' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('demand')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Demand</h3>
                <div className={`text-xl font-bold ${getScoreColor(dailyProductData.scores.demand)}`}>
                  {dailyProductData.scores.demand}
                </div>
              </CardContent>
            </Card>

            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'competition' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('competition')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Competition</h3>
                <div className={`text-xl font-bold ${getScoreColor(dailyProductData.scores.competition)}`}>
                  {dailyProductData.scores.competition}
                </div>
              </CardContent>
            </Card>

            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'keywords' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('keywords')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Keywords</h3>
                <div className={`text-xl font-bold ${getScoreColor(dailyProductData.scores.keywords)}`}>
                  {dailyProductData.scores.keywords}
                </div>
              </CardContent>
            </Card>

            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'financial' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('financial')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Launch Strategy</h3>
                <div className={`text-xl font-bold ${getScoreColor(dailyProductData.scores.financial)}`}>
                  {dailyProductData.scores.financial}
                </div>
              </CardContent>
            </Card>

            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'listing' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('listing')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Listing Optimization</h3>
                <div className="text-xl font-bold text-orange-600">B+</div>
              </CardContent>
            </Card>

            <Card 
              className={`cursor-pointer transition-all duration-200 ${
                activeTab === 'financial-analysis' 
                  ? 'ring-2 ring-blue-500 shadow-lg scale-105' 
                  : 'hover:shadow-md hover:scale-105 bg-white/80 backdrop-blur'
              }`}
              onClick={() => setActiveTab('financial-analysis')}
            >
              <CardContent className="p-2 text-center">
                <h3 className="text-xs font-medium text-gray-600 mb-1">Financial Analysis</h3>
                <div className="text-xl font-bold text-green-600">A</div>
              </CardContent>
            </Card>
            </div>
          </div>
        </div>
      </div>

      {/* Tab Content */}
      <div className="min-h-screen bg-gray-50">
        {/* Demand Analysis Section */}
        {activeTab === 'demand' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-12">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Demand Analysis</h2>
            <p className="text-lg text-gray-600">Understanding market demand and customer behavior</p>
          </div>

          {/* AI Brief */}
          <div className="mb-12">
            <Card className="bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200">
              <CardContent className="p-6">
                <div className="flex items-start space-x-4">
                  <div className="p-3 bg-blue-100 rounded-full">
                    <Sparkles className="h-6 w-6 text-blue-600" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Market Intelligence</h3>
                    <p className="text-gray-700 mb-4">
                      The sleep technology market shows exceptional demand with 45,000+ monthly searches for Bluetooth sleep masks. 
                      Strong growth indicators include 15% annual market expansion and high conversion rates above industry average. 
                      Customer avatars reveal diverse use cases from night shift workers to meditation enthusiasts, suggesting broad market appeal.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <Badge className="bg-green-100 text-green-800">High Demand</Badge>
                      <Badge className="bg-blue-100 text-blue-800">Growing Market</Badge>
                      <Badge className="bg-purple-100 text-purple-800">Multiple Use Cases</Badge>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Key Performance Metrics */}
          <div className="mb-12">
            <h3 className="text-xl font-semibold text-gray-900 mb-6">Key Performance Metrics</h3>
            
            {/* Monthly Metrics */}
            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
              <Card className="hover:shadow-lg transition-shadow">
                <CardContent className="p-6 text-center">
                  <p className="text-sm font-medium text-gray-500 mb-2">Monthly Revenue</p>
                  <p className="text-2xl font-bold text-gray-900">${dailyProductData.financialData.monthlyProjections.revenue.toLocaleString()}</p>
                  <p className="text-xs text-gray-500 mt-1">Per month</p>
                </CardContent>
              </Card>

              <Card className="hover:shadow-lg transition-shadow">
                <CardContent className="p-6 text-center">
                  <p className="text-sm font-medium text-gray-500 mb-2">Monthly Profit</p>
                  <p className="text-2xl font-bold text-green-600">${dailyProductData.financialData.monthlyProjections.profit.toLocaleString()}</p>
                  <p className="text-xs text-gray-500 mt-1">Net income</p>
                </CardContent>
              </Card>

              <Card className="hover:shadow-lg transition-shadow">
                <CardContent className="p-6 text-center">
                  <p className="text-sm font-medium text-gray-500 mb-2">Avg Conversion Rate</p>
                  <p className="text-2xl font-bold text-blue-600">{dailyProductData.financialData.avgConversionRate}%</p>
                  <p className="text-xs text-gray-500 mt-1">Industry avg: 8%</p>
                </CardContent>
              </Card>

              <Card className="hover:shadow-lg transition-shadow">
                <CardContent className="p-6 text-center">
                  <p className="text-sm font-medium text-gray-500 mb-2">Monthly Orders</p>
                  <p className="text-2xl font-bold text-gray-900">{dailyProductData.financialData.monthlyOrders.toLocaleString()}</p>
                  <p className="text-xs text-gray-500 mt-1">Units sold</p>
                </CardContent>
              </Card>

              <Card className="hover:shadow-lg transition-shadow">
                <CardContent className="p-6 text-center">
                  <p className="text-sm font-medium text-gray-500 mb-2">Monthly Clicks</p>
                  <p className="text-2xl font-bold text-gray-900">{dailyProductData.financialData.monthlyClicks.toLocaleString()}</p>
                  <p className="text-xs text-gray-500 mt-1">Traffic volume</p>
                </CardContent>
              </Card>

              <Card className="hover:shadow-lg transition-shadow">
                <CardContent className="p-6 text-center">
                  <p className="text-sm font-medium text-gray-500 mb-2">Keyword Depth</p>
                  <p className="text-2xl font-bold text-purple-600">{dailyProductData.financialData.keywordDepthGrade}</p>
                  <p className="text-xs text-gray-500 mt-1">Ranking quality</p>
                </CardContent>
              </Card>
            </div>
          </div>

          {/* Amazon Brand Analytics Search Terms - Full Width */}
          <div className="mb-12">
            <Card>
              <CardHeader>
                <CardTitle className="text-lg flex items-center justify-between">
                  <span>Amazon Brand Analytics - Search Terms Report</span>
                  {searchTermsData?.mock && (
                    <Badge variant="outline" className="text-xs">Mock Data</Badge>
                  )}
                  {searchTermsData?.cached && (
                    <Badge variant="outline" className="text-xs">Cached</Badge>
                  )}
                </CardTitle>
                <CardDescription>
                  {searchTermsLoading ? 'Loading Amazon search analytics...' : 'Weekly search frequency ranking and click share data'}
                </CardDescription>
              </CardHeader>
              <CardContent>
                {searchTermsError ? (
                  <div className="h-auto p-8 flex items-center justify-center">
                    <div className="text-center">
                      <p className="text-red-600 mb-2">Failed to load search terms data</p>
                      <p className="text-sm text-gray-500">{searchTermsError}</p>
                    </div>
                  </div>
                ) : searchTermsLoading ? (
                  <div className="h-64 flex items-center justify-center">
                    <div className="text-center">
                      <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                      <p className="text-gray-600">Fetching Amazon search analytics...</p>
                    </div>
                  </div>
                ) : searchTermsData?.trends && searchTermsData.trends.length > 0 ? (
                  <div className="space-y-6">
                    {/* Search Terms Ranking Table */}
                    <div className="overflow-x-auto">
                      <table className="w-full">
                        <thead>
                          <tr className="border-b bg-gray-50">
                            <th className="text-left p-4 font-medium text-gray-700">Keyword</th>
                            <th className="text-center p-4 font-medium text-gray-700">Search Rank</th>
                            <th className="text-center p-4 font-medium text-gray-700">Weekly Volume</th>
                            <th className="text-center p-4 font-medium text-gray-700">Growth</th>
                            <th className="text-center p-4 font-medium text-gray-700">Top 3 Click Share</th>
                            <th className="text-center p-4 font-medium text-gray-700">Conversion</th>
                            <th className="text-right p-4 font-medium text-gray-700">Top ASINs</th>
                          </tr>
                        </thead>
                        <tbody>
                          {searchTermsData.trends.map((term, index) => (
                            <tr key={index} className="border-b hover:bg-gray-50">
                              <td className="p-4">
                                <div className="flex items-center gap-2">
                                  <span className="font-medium text-gray-900">{term.keyword}</span>
                                  <Badge variant="outline" className="text-xs">
                                    #{term.searchFrequencyRank}
                                  </Badge>
                                </div>
                              </td>
                              <td className="p-4 text-center">
                                <div className="inline-flex items-center gap-2">
                                  <span className="text-lg font-semibold">{term.searchFrequencyRank}</span>
                                  <ArrowUp className={`h-3 w-3 ${term.searchFrequencyRank < 500 ? 'text-green-600' : 'text-gray-400'}`} />
                                </div>
                              </td>
                              <td className="p-4 text-center">
                                <div>
                                  <p className="font-semibold">{term.weeklySearchVolume.toLocaleString()}</p>
                                  <p className="text-xs text-gray-500">searches/week</p>
                                </div>
                              </td>
                              <td className="p-4 text-center">
                                <span className={`inline-flex items-center gap-1 font-medium ${
                                  term.weeklySearchVolumeGrowth > 0 ? 'text-green-600' : 'text-red-600'
                                }`}>
                                  {term.weeklySearchVolumeGrowth > 0 ? '+' : ''}{term.weeklySearchVolumeGrowth.toFixed(2)}%
                                </span>
                              </td>
                              <td className="p-4 text-center">
                                <div className="flex flex-col items-center">
                                  <span className="font-semibold">{term.top3ClickShare.toFixed(2)}%</span>
                                  <Progress value={term.top3ClickShare} className="w-20 h-2 mt-1" />
                                </div>
                              </td>
                              <td className="p-4 text-center">
                                <span className="text-sm">{term.top3ConversionShare.toFixed(2)}%</span>
                              </td>
                              <td className="p-4">
                                <div className="flex justify-end gap-2">
                                  {term.topASINs.slice(0, 3).map((asin, i) => (
                                    <div key={i} className="group relative">
                                      <img
                                        src={`https://via.placeholder.com/40x40?text=${i+1}`}
                                        alt={asin.title}
                                        className="w-10 h-10 rounded border hover:scale-110 transition-transform cursor-pointer"
                                      />
                                      <div className="absolute bottom-full mb-2 right-0 hidden group-hover:block z-10 w-64 p-3 bg-white rounded-lg shadow-lg border">
                                        <p className="text-xs font-medium text-gray-900 mb-1">{asin.title}</p>
                                        <div className="flex justify-between text-xs text-gray-600">
                                          <span>Click: {asin.clickShare.toFixed(1)}%</span>
                                          <span>Conv: {asin.conversionShare.toFixed(1)}%</span>
                                        </div>
                                      </div>
                                    </div>
                                  ))}
                                </div>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>

                    {/* Trend Charts for Primary Keyword */}
                    {searchTermsData.trends[0] && (
                      <div className="mt-8 space-y-4">
                        <h4 className="text-sm font-medium text-gray-900">
                          Search Volume Trend - {searchTermsData.trends[0].keyword}
                        </h4>
                        
                        {/* Mini chart for search volume trend */}
                        <div className="h-32 bg-gray-50 rounded-lg p-4">
                          <svg viewBox="0 0 800 100" className="w-full h-full" preserveAspectRatio="none">
                            {(() => {
                              const trendData = searchTermsData.trends[0].trendData
                              const maxVolume = Math.max(...trendData.map(d => d.searchVolume))
                              const minVolume = Math.min(...trendData.map(d => d.searchVolume))
                              const range = maxVolume - minVolume || 1
                              
                              const points = trendData.map((data, index) => ({
                                x: (index / (trendData.length - 1)) * 780 + 10,
                                y: 90 - ((data.searchVolume - minVolume) / range) * 80
                              }))
                              
                              const pathData = points.map((p, i) => 
                                `${i === 0 ? 'M' : 'L'} ${p.x} ${p.y}`
                              ).join(' ')
                              
                              return (
                                <>
                                  <path 
                                    d={pathData} 
                                    fill="none" 
                                    stroke="#3b82f6" 
                                    strokeWidth="2"
                                  />
                                  {points.map((point, index) => (
                                    <g key={index}>
                                      <circle 
                                        cx={point.x} 
                                        cy={point.y} 
                                        r="3" 
                                        fill="#3b82f6"
                                      />
                                      <text
                                        x={point.x}
                                        y={point.y - 10}
                                        textAnchor="middle"
                                        className="text-xs fill-gray-600"
                                      >
                                        {(trendData[index].searchVolume / 1000).toFixed(0)}k
                                      </text>
                                    </g>
                                  ))}
                                </>
                              )
                            })()}
                          </svg>
                        </div>
                        
                        <div className="flex items-center justify-between text-xs text-gray-600">
                          <span>4 weeks ago</span>
                          <span>Current week</span>
                        </div>
                      </div>
                    )}
                  </div>
                ) : (
                  <div className="h-64 flex items-center justify-center">
                    <p className="text-gray-500">No search terms data available</p>
                  </div>
                )}
              </CardContent>
            </Card>
          </div>


          {/* Social Signals */}
          <div>
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Social Media Signals</h3>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
              <Card>
                <CardContent className="p-6 text-center">
                  <div className="p-3 bg-pink-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                    <Globe className="h-6 w-6 text-pink-600" />
                  </div>
                  <p className="text-sm font-medium text-gray-500 mb-2">TikTok</p>
                  <p className="text-xl font-bold text-gray-900 mb-3">{dailyProductData.demandData.socialSignals.tiktok.posts}</p>
                  <div className="space-y-1 text-sm">
                    <p className="text-gray-500">Views: <span className="font-medium text-gray-900">{(dailyProductData.demandData.socialSignals.tiktok.views / 1000000).toFixed(1)}M</span></p>
                    <p className="text-gray-500">Engagement: <span className="font-medium text-gray-900">{dailyProductData.demandData.socialSignals.tiktok.engagement}</span></p>
                  </div>
                </CardContent>
              </Card>

              <Card>
                <CardContent className="p-6 text-center">
                  <div className="p-3 bg-purple-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                    <MessageSquare className="h-6 w-6 text-purple-600" />
                  </div>
                  <p className="text-sm font-medium text-gray-500 mb-2">Instagram</p>
                  <p className="text-xl font-bold text-gray-900 mb-3">{dailyProductData.demandData.socialSignals.instagram.posts}</p>
                  <p className="text-sm text-gray-500">Engagement: <span className="font-medium text-gray-900">{dailyProductData.demandData.socialSignals.instagram.engagement}</span></p>
                </CardContent>
              </Card>

              <Card>
                <CardContent className="p-6 text-center">
                  <div className="p-3 bg-red-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                    <Activity className="h-6 w-6 text-red-600" />
                  </div>
                  <p className="text-sm font-medium text-gray-500 mb-2">YouTube</p>
                  <p className="text-xl font-bold text-gray-900 mb-3">{dailyProductData.demandData.socialSignals.youtube.videos}</p>
                  <p className="text-sm text-gray-500">Avg Views: <span className="font-medium text-gray-900">{(dailyProductData.demandData.socialSignals.youtube.avgViews / 1000).toFixed(0)}K</span></p>
                </CardContent>
              </Card>

              <Card>
                <CardContent className="p-6 text-center">
                  <div className="p-3 bg-orange-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                    <FileText className="h-6 w-6 text-orange-600" />
                  </div>
                  <p className="text-sm font-medium text-gray-500 mb-2">Reddit</p>
                  <p className="text-xl font-bold text-gray-900 mb-3">{dailyProductData.demandData.socialSignals.reddit.discussions}</p>
                  <p className="text-sm text-gray-500">Sentiment: <span className="font-medium capitalize text-green-600">{dailyProductData.demandData.socialSignals.reddit.sentiment}</span></p>
                </CardContent>
              </Card>
            </div>
          </div>
            </div>
          </section>
        )}

        {/* Competition Analysis Section */}
        {activeTab === 'competition' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-12">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Competition Analysis</h2>
            <p className="text-lg text-gray-600">Understanding the competitive landscape</p>
          </div>

          {/* AI Brief */}
          <div className="mb-12">
            <Card className="bg-gradient-to-r from-orange-50 to-red-50 border-orange-200">
              <CardContent className="p-6">
                <div className="flex items-start space-x-4">
                  <div className="p-3 bg-orange-100 rounded-full">
                    <Sparkles className="h-6 w-6 text-orange-600" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Competitive Intelligence</h3>
                    <p className="text-gray-700 mb-4">
                      Analysis of 127 competitors reveals a fragmented market with the top 3 players controlling only 54.5% market share. 
                      MUSICOZY leads with 23.5% keyword strength, focusing on premium positioning. Price clustering around $20-30 suggests 
                      opportunity for differentiation through features rather than pricing alone.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <Badge className="bg-orange-100 text-orange-800">Fragmented Market</Badge>
                      <Badge className="bg-red-100 text-red-800">Feature Opportunity</Badge>
                      <Badge className="bg-yellow-100 text-yellow-800">Price Competitive</Badge>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          <div className="grid grid-cols-1 lg:grid-cols-4 gap-8 mb-12">
            <Card>
              <CardContent className="p-6 text-center">
                <div className="p-3 bg-blue-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                  <Users className="h-6 w-6 text-blue-600" />
                </div>
                <p className="text-sm font-medium text-gray-500 mb-2">Total Competitors</p>
                <p className="text-2xl font-bold text-gray-900">{dailyProductData.competitionData.totalCompetitors}</p>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-6 text-center">
                <div className="p-3 bg-yellow-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                  <Star className="h-6 w-6 text-yellow-600" />
                </div>
                <p className="text-sm font-medium text-gray-500 mb-2">Avg Rating</p>
                <p className="text-2xl font-bold text-gray-900">{dailyProductData.competitionData.averageRating}</p>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-6 text-center">
                <div className="p-3 bg-green-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                  <MessageSquare className="h-6 w-6 text-green-600" />
                </div>
                <p className="text-sm font-medium text-gray-500 mb-2">Avg Reviews</p>
                <p className="text-2xl font-bold text-gray-900">{dailyProductData.competitionData.averageReviews.toLocaleString()}</p>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-6 text-center">
                <div className="p-3 bg-purple-50 rounded-full w-12 h-12 mx-auto mb-4 flex items-center justify-center">
                  <DollarSign className="h-6 w-6 text-purple-600" />
                </div>
                <p className="text-sm font-medium text-gray-500 mb-2">Avg Price</p>
                <p className="text-2xl font-bold text-gray-900">${dailyProductData.competitionData.averagePrice}</p>
              </CardContent>
            </Card>
          </div>

          {/* Competitor Listing Analysis */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Competitor Listing Analysis</h3>
            <div className="space-y-6">
              {dailyProductData.competitionData.topCompetitors.map((competitor, index) => (
                <Card key={index}>
                  <CardContent className="p-6">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="text-lg font-semibold text-gray-900">{competitor.name}</h4>
                      <Badge className="bg-blue-100 text-blue-800">
                        {competitor.keywordStrength}% Keyword Strength
                      </Badge>
                    </div>
                    
                    {/* Product Images */}
                    <div className="mb-4">
                      <h5 className="font-medium text-gray-900 mb-3">Product Images:</h5>
                      <div className="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-2">
                        {/* Main Image */}
                        <div className="relative">
                          <img
                            src={competitor.mainImage}
                            alt={`${competitor.name} main`}
                            className="w-full aspect-square object-cover rounded-lg border-2 border-blue-500 hover:scale-105 transition-transform cursor-pointer"
                          />
                          <div className="absolute top-1 left-1 bg-blue-500 text-white text-xs px-1 py-0.5 rounded">Main</div>
                        </div>
                        {/* Additional Images */}
                        {competitor.images.slice(0, 5).map((image, imgIndex) => (
                          <img
                            key={imgIndex}
                            src={image}
                            alt={`${competitor.name} image ${imgIndex + 1}`}
                            className="w-full aspect-square object-cover rounded-lg border hover:scale-105 transition-transform cursor-pointer hover:border-gray-400"
                          />
                        ))}
                      </div>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                      {/* Title Analysis */}
                      <div>
                        <h5 className="font-medium text-gray-900 mb-2">Title:</h5>
                        <p className="text-sm text-gray-700 mb-4">{competitor.listing.title}</p>
                        <h5 className="font-medium text-gray-900 mb-2">Target Keywords:</h5>
                        <div className="flex flex-wrap gap-1">
                          {competitor.listing.keywords.map((keyword, i) => (
                            <Badge key={i} variant="outline" className="text-xs">
                              {keyword}
                            </Badge>
                          ))}
                        </div>
                      </div>

                      {/* Bullet Points */}
                      <div>
                        <h5 className="font-medium text-gray-900 mb-2">Key Bullet Points:</h5>
                        <ul className="space-y-1">
                          {competitor.listing.bulletPoints.slice(0, 3).map((bullet, i) => (
                            <li key={i} className="text-xs text-gray-600">
                               {bullet.length > 60 ? bullet.substring(0, 60) + '...' : bullet}
                            </li>
                          ))}
                        </ul>
                      </div>

                      {/* Performance Metrics */}
                      <div>
                        <h5 className="font-medium text-gray-900 mb-2">Performance:</h5>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between">
                            <span className="text-gray-500">Conversion Rate:</span>
                            <span className="font-medium">{competitor.conversionRate}%</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-500">Monthly Revenue:</span>
                            <span className="font-medium text-green-600">${competitor.monthlyRevenue.toLocaleString()}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-500">Rating:</span>
                            <div className="flex items-center">
                              <Star className="h-3 w-3 text-yellow-400 mr-1" />
                              <span className="font-medium">{competitor.rating}</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </div>

          {/* Price Distribution Scatter Plot */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Price Distribution Analysis</h3>
            <Card>
              <CardContent className="p-6">
                <div className="h-80 w-full mb-6">
                  <svg viewBox="0 0 1200 320" className="w-full h-full">
                    {/* Grid lines */}
                    <defs>
                      <pattern id="priceGrid" width="100" height="40" patternUnits="userSpaceOnUse">
                        <path d="M 100 0 L 0 0 0 40" fill="none" stroke="#f3f4f6" strokeWidth="1"/>
                      </pattern>
                    </defs>
                    <rect width="1200" height="320" fill="url(#priceGrid)" />
                    
                    {/* Y-axis line */}
                    <line x1="60" y1="20" x2="60" y2="280" stroke="#6b7280" strokeWidth="2" />
                    {/* X-axis line */}
                    <line x1="60" y1="280" x2="1140" y2="280" stroke="#6b7280" strokeWidth="2" />
                    
                    {/* Generate price points */}
                    {(() => {
                      // Generate sample data points across price ranges
                      const allPoints = [];
                      const priceRanges = [
                        { min: 0, max: 20, count: 34, color: '#3b82f6' },
                        { min: 20, max: 30, count: 52, color: '#10b981' },
                        { min: 30, max: 40, count: 28, color: '#f59e0b' },
                        { min: 40, max: 60, count: 13, color: '#ef4444' }
                      ];
                      
                      priceRanges.forEach((range, rangeIndex) => {
                        for (let i = 0; i < range.count; i++) {
                          const price = range.min + Math.random() * (range.max - range.min);
                          const salesRank = 1000 + Math.random() * 99000 * (1 + rangeIndex * 0.5);
                          allPoints.push({
                            price,
                            salesRank,
                            color: range.color,
                            size: 6 - rangeIndex
                          });
                        }
                      });
                      
                      
                      return allPoints.map((point, index) => {
                        const x = 60 + (point.price / 60) * 1080;
                        const y = 280 - (Math.log10(100000 - point.salesRank + 1) / Math.log10(100000)) * 260;
                        
                        return (
                          <g key={index}>
                            <circle
                              cx={x}
                              cy={y}
                              r={point.size}
                              fill={point.color}
                              fillOpacity={point.isCurrent ? 1 : 0.6}
                              stroke={point.isCurrent ? '#fff' : 'none'}
                              strokeWidth={point.isCurrent ? 2 : 0}
                            />
                            {point.isCurrent && (
                              <text
                                x={x}
                                y={y - 15}
                                textAnchor="middle"
                                className="text-sm font-medium fill-gray-900"
                              >
                                Current
                              </text>
                            )}
                          </g>
                        );
                      });
                    })()}
                    
                    {/* Percentile lines */}
                    {[25, 50, 75].map(percentile => {
                      const y = 280 - (percentile / 100) * 260;
                      return (
                        <g key={percentile}>
                          <line
                            x1="60"
                            y1={y}
                            x2="1140"
                            y2={y}
                            stroke="#e5e7eb"
                            strokeWidth="1"
                            strokeDasharray="5,5"
                          />
                          <text
                            x="45"
                            y={y + 5}
                            textAnchor="end"
                            className="text-xs fill-gray-500"
                          >
                            {percentile}th
                          </text>
                        </g>
                      );
                    })}
                    
                    {/* Axis labels */}
                    <text x="600" y="310" textAnchor="middle" className="text-sm fill-gray-600">
                      Price ($)
                    </text>
                    <text x="30" y="150" textAnchor="middle" className="text-sm fill-gray-600" transform="rotate(-90 30 150)">
                      Sales Rank (Better )
                    </text>
                    
                    {/* Price labels */}
                    {[0, 10, 20, 30, 40, 50, 60].map(price => (
                      <text
                        key={price}
                        x={60 + (price / 60) * 1080}
                        y={295}
                        textAnchor="middle"
                        className="text-xs fill-gray-500"
                      >
                        ${price}
                      </text>
                    ))}
                  </svg>
                </div>
                
                {/* Legend */}
                <div className="flex flex-wrap items-center justify-center gap-6 text-sm mb-6">
                  <div className="flex items-center">
                    <div className="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                    <span className="text-gray-600">$0-20 (34 products)</span>
                  </div>
                  <div className="flex items-center">
                    <div className="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                    <span className="text-gray-600">$20-30 (52 products)</span>
                  </div>
                  <div className="flex items-center">
                    <div className="w-3 h-3 bg-amber-500 rounded-full mr-2"></div>
                    <span className="text-gray-600">$30-40 (28 products)</span>
                  </div>
                  <div className="flex items-center">
                    <div className="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                    <span className="text-gray-600">$40+ (13 products)</span>
                  </div>
                </div>
                
                {/* Percentile Documentation */}
                <div className="bg-gray-50 rounded-lg p-4">
                  <h4 className="font-semibold text-gray-900 mb-3">Market Percentile Analysis</h4>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div>
                      <p className="font-medium text-gray-700">25th Percentile</p>
                      <p className="text-gray-600">Budget Range</p>
                      <p className="text-lg font-semibold text-gray-900">$15-20</p>
                    </div>
                    <div>
                      <p className="font-medium text-gray-700">50th Percentile</p>
                      <p className="text-gray-600">Market Average</p>
                      <p className="text-lg font-semibold text-gray-900">$25-30</p>
                    </div>
                    <div>
                      <p className="font-medium text-gray-700">75th Percentile</p>
                      <p className="text-gray-600">Premium Range</p>
                      <p className="text-lg font-semibold text-gray-900">$35-40</p>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

            </div>
          </section>
        )}

        {/* Market & Customer Intelligence Section */}
        {activeTab === 'market' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-12">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Market & Customer Intelligence</h2>
            <p className="text-lg text-gray-600">Understanding your customers through demographic analysis and review insights</p>
          </div>

          {/* AI Sentiment Intelligence Brief */}
          <div className="mb-12">
            <Card className="bg-gradient-to-r from-green-50 to-emerald-50 border-green-200">
              <CardContent className="p-6">
                <div className="flex items-start space-x-4">
                  <div className="p-3 bg-green-100 rounded-full">
                    <Sparkles className="h-6 w-6 text-green-600" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Sentiment Intelligence</h3>
                    <p className="text-gray-700 mb-4">
                      Analysis of 36,624+ reviews reveals overwhelmingly positive sentiment (4.2/5) across competitors. 
                      Key themes include comfort for side sleepers and sound quality, while control placement and durability 
                      present opportunities for improvement. Premium positioning justified by battery life and materials.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <Badge className="bg-green-100 text-green-800">Positive Sentiment</Badge>
                      <Badge className="bg-blue-100 text-blue-800">Comfort Focus</Badge>
                      <Badge className="bg-purple-100 text-purple-800">Control Opportunity</Badge>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Customer Sentiment Overview */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Customer Sentiment Analysis</h3>
            <div className="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
              <Card>
                <CardContent className="p-6 text-center">
                  <div className="text-3xl font-bold text-green-600 mb-2">{dailyProductData.reviewAnalysisData.sentimentScore}</div>
                  <div className="text-sm font-medium text-gray-900">Overall Score</div>
                  <div className="text-xs text-gray-500 capitalize">{dailyProductData.reviewAnalysisData.overallSentiment}</div>
                </CardContent>
              </Card>
              <Card>
                <CardContent className="p-6 text-center">
                  <div className="text-3xl font-bold text-blue-600 mb-2">{dailyProductData.reviewAnalysisData.totalReviews.toLocaleString()}</div>
                  <div className="text-sm font-medium text-gray-900">Total Reviews</div>
                  <div className="text-xs text-gray-500">Analyzed</div>
                </CardContent>
              </Card>
              <Card>
                <CardContent className="p-6 text-center">
                  <div className="text-3xl font-bold text-purple-600 mb-2">{dailyProductData.reviewAnalysisData.competitorReviews.length}</div>
                  <div className="text-sm font-medium text-gray-900">Competitors</div>
                  <div className="text-xs text-gray-500">Analyzed</div>
                </CardContent>
              </Card>
              <Card>
                <CardContent className="p-6 text-center">
                  <div className="text-3xl font-bold text-orange-600 mb-2">{dailyProductData.reviewAnalysisData.commonThemes.opportunities.length}</div>
                  <div className="text-sm font-medium text-gray-900">Opportunities</div>
                  <div className="text-xs text-gray-500">Identified</div>
                </CardContent>
              </Card>
            </div>

            {/* Common Themes and Opportunities */}
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <Card>
                <CardHeader>
                  <CardTitle className="text-green-600">Common Positives</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2">
                    {dailyProductData.reviewAnalysisData.commonThemes.positive.map((theme, index) => (
                      <li key={index} className="flex items-center">
                        <ThumbsUp className="h-4 w-4 text-green-500 mr-2" />
                        <span className="text-sm capitalize">{theme}</span>
                      </li>
                    ))}
                  </ul>
                </CardContent>
              </Card>
              
              <Card>
                <CardHeader>
                  <CardTitle className="text-red-600">Common Negatives</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2">
                    {dailyProductData.reviewAnalysisData.commonThemes.negative.map((theme, index) => (
                      <li key={index} className="flex items-center">
                        <ThumbsDown className="h-4 w-4 text-red-500 mr-2" />
                        <span className="text-sm capitalize">{theme}</span>
                      </li>
                    ))}
                  </ul>
                </CardContent>
              </Card>
              
              <Card>
                <CardHeader>
                  <CardTitle className="text-purple-600">Opportunities</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2">
                    {dailyProductData.reviewAnalysisData.commonThemes.opportunities.map((opportunity, index) => (
                      <li key={index} className="flex items-center">
                        <Lightbulb className="h-4 w-4 text-purple-500 mr-2" />
                        <span className="text-sm capitalize">{opportunity}</span>
                      </li>
                    ))}
                  </ul>
                </CardContent>
              </Card>
            </div>
          </div>

          {/* Customer Avatars */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Customer Avatars</h3>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {dailyProductData.demandData.customerAvatars.map((avatar, index) => (
                <Card key={index} className="hover:shadow-md transition-shadow bg-white">
                  <CardContent className="p-6">
                    <div className="flex items-center mb-4">
                      <div className="p-3 bg-gradient-to-br from-purple-100 to-indigo-100 rounded-full mr-4">
                        <UserCheck className="h-6 w-6 text-purple-600" />
                      </div>
                      <div>
                        <h4 className="font-semibold text-gray-900">{avatar.name}</h4>
                        <p className="text-sm text-gray-500">Age: {avatar.age}</p>
                      </div>
                    </div>
                    <div className="space-y-3">
                      <div>
                        <div className="flex items-center mb-1">
                          <div className="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                          <p className="text-sm font-medium text-gray-700">Pain Point</p>
                        </div>
                        <p className="text-sm text-gray-600 ml-4">{avatar.pain}</p>
                      </div>
                      <div>
                        <div className="flex items-center mb-1">
                          <div className="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                          <p className="text-sm font-medium text-gray-700">Motivation</p>
                        </div>
                        <p className="text-sm text-gray-600 ml-4">{avatar.motivation}</p>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </div>

          {/* Market Size & Demographics */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Market Demographics & Behavior</h3>
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <Card>
              <CardHeader>
                <CardTitle>Market Demographics</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Primary Age Range</span>
                    <span className="font-semibold">25-45 years</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Gender Split</span>
                    <span className="font-semibold">60% Female, 40% Male</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Income Level</span>
                    <span className="font-semibold">$40K-$80K</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Location</span>
                    <span className="font-semibold">Urban & Suburban</span>
                  </div>
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardHeader>
                <CardTitle>Purchase Behavior</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Purchase Frequency</span>
                    <span className="font-semibold">Every 6-12 months</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Decision Time</span>
                    <span className="font-semibold">3-7 days</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Key Decision Factor</span>
                    <span className="font-semibold">Comfort & Reviews</span>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-gray-600">Price Sensitivity</span>
                    <span className="font-semibold">Medium</span>
                  </div>
                </div>
              </CardContent>
            </Card>
            </div>
          </div>
            </div>
          </section>
        )}

        {/* Keyword Analysis Section */}
        {activeTab === 'keywords' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-12">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Keyword Analysis</h2>
            <p className="text-lg text-gray-600">Strategic keywords driving product discovery</p>
          </div>

          {/* AI Brief */}
          <div className="mb-12">
            <Card className="bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200">
              <CardContent className="p-6">
                <div className="flex items-start space-x-4">
                  <div className="p-3 bg-purple-100 rounded-full">
                    <Sparkles className="h-6 w-6 text-purple-600" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Keyword Intelligence</h3>
                    <p className="text-gray-700 mb-4">
                      "Bluetooth sleep mask" leads revenue generation with $145K monthly potential and 12.5% conversion rate. 
                      Medium difficulty keywords present balanced opportunity between competition and reach. Focus on long-tail 
                      variations like "sleep headphones mask" for easier ranking with strong $67K monthly revenue potential.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <Badge className="bg-purple-100 text-purple-800">Revenue Focused</Badge>
                      <Badge className="bg-blue-100 text-blue-800">Conversion Optimized</Badge>
                      <Badge className="bg-green-100 text-green-800">Long-tail Opportunity</Badge>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Keyword Network Visualization */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Keyword Network</h3>
            <Card>
              <CardContent className="p-6">
                <KeywordNetwork 
                  keywordClusters={dailyProductData.keywordsData.keywordClusters} 
                  primaryKeyword={dailyProductData.keywordsData.primaryKeyword}
                />
              </CardContent>
            </Card>
          </div>

          {/* Keyword Pivot Table */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Keyword Performance Hierarchy</h3>
            <Card>
              <CardContent className="p-0">
                <KeywordPivotTable keywordHierarchy={dailyProductData.keywordsData.keywordHierarchy} />
              </CardContent>
            </Card>
          </div>
            </div>
          </section>
        )}

        {/* Listing Optimization Section */}
        {activeTab === 'listing' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-12">
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Listing Optimization</h2>
            <p className="text-lg text-gray-600">Analyze competitor listings and create optimized content strategy</p>
          </div>

          {/* AI Brief */}
          <div className="mb-12">
            <Card className="bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-200">
              <CardContent className="p-6">
                <div className="flex items-start space-x-4">
                  <div className="p-3 bg-indigo-100 rounded-full">
                    <Sparkles className="h-6 w-6 text-indigo-600" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Listing Intelligence</h3>
                    <p className="text-gray-700 mb-4">
                      Competitor analysis reveals strong patterns in title structure and image positioning. Hero shots focus on white backgrounds 
                      while lifestyle images emphasize comfort and sleep quality. Opportunity exists in technical feature communication and 
                      mobile-optimized text hierarchy for improved conversion rates.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <Badge className="bg-indigo-100 text-indigo-800">Title Optimization</Badge>
                      <Badge className="bg-blue-100 text-blue-800">Image Strategy</Badge>
                      <Badge className="bg-purple-100 text-purple-800">Mobile First</Badge>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Title Optimization */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Title Optimization Strategy</h3>
            <Card>
              <CardContent className="p-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                  <div>
                    <h4 className="text-lg font-semibold text-gray-900 mb-4">Current Pattern Analysis</h4>
                    <p className="text-gray-600 mb-4">{dailyProductData.listingOptimizationData.titleOptimization.currentPattern}</p>
                    <div className="space-y-3">
                      <h5 className="font-medium text-gray-900">Optimization Recommendations:</h5>
                      <ul className="space-y-2">
                        {dailyProductData.listingOptimizationData.titleOptimization.recommendations.map((rec, index) => (
                          <li key={index} className="flex items-start">
                            <CheckCircle className="h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0" />
                            <span className="text-sm text-gray-700">{rec}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  </div>
                  <div>
                    <h4 className="text-lg font-semibold text-gray-900 mb-4">Suggested Title</h4>
                    <div className="p-4 bg-green-50 border border-green-200 rounded-lg">
                      <p className="text-gray-900 font-medium">{dailyProductData.listingOptimizationData.titleOptimization.suggestedTitle}</p>
                    </div>
                    <div className="mt-4">
                      <h5 className="font-medium text-gray-900 mb-2">Bullet Point Structure:</h5>
                      <p className="text-sm text-gray-600 mb-2">{dailyProductData.listingOptimizationData.bulletPointOptimization.structure}</p>
                      <ul className="space-y-1">
                        {dailyProductData.listingOptimizationData.bulletPointOptimization.recommendations.map((rec, index) => (
                          <li key={index} className="text-sm text-gray-700"> {rec}</li>
                        ))}
                      </ul>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Image Position Analysis */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Image Position Strategy</h3>
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
              {Object.entries(dailyProductData.listingOptimizationData.imageAnalysis).map(([position, data]) => (
                <Card key={position} className="hover:shadow-lg transition-shadow">
                  <CardContent className="p-6">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="text-lg font-semibold text-gray-900 capitalize">
                        {position.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}
                      </h4>
                      <Badge variant="outline">
                        {data.competitorImages.length} Examples
                      </Badge>
                    </div>
                    
                    {/* Competitor Images */}
                    {data.competitorImages.length > 0 && (
                      <div className="mb-4">
                        <h5 className="text-sm font-medium text-gray-700 mb-2">Competitor Examples:</h5>
                        <div className="grid grid-cols-3 gap-2">
                          {data.competitorImages.map((image, index) => (
                            <img
                              key={index}
                              src={image}
                              alt={`${position} example ${index + 1}`}
                              className="w-full h-16 object-cover rounded border hover:scale-105 transition-transform"
                            />
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Common Themes */}
                    <div className="mb-4">
                      <h5 className="text-sm font-medium text-gray-700 mb-2">Common Themes:</h5>
                      <div className="flex flex-wrap gap-1">
                        {data.commonThemes.map((theme, index) => (
                          <Badge key={index} variant="outline" className="text-xs">
                            {theme}
                          </Badge>
                        ))}
                      </div>
                    </div>

                    {/* Creative Brief */}
                    <div className="mb-4">
                      <h5 className="text-sm font-medium text-gray-700 mb-2">Creative Brief:</h5>
                      <p className="text-sm text-gray-600 leading-relaxed">{data.creativeBrief}</p>
                    </div>

                    {/* Optimization Tips */}
                    <div>
                      <h5 className="text-sm font-medium text-gray-700 mb-2">Optimization Tips:</h5>
                      <ul className="space-y-1">
                        {data.optimizationTips.map((tip, index) => (
                          <li key={index} className="flex items-start">
                            <Lightbulb className="h-3 w-3 text-yellow-500 mr-2 mt-1 flex-shrink-0" />
                            <span className="text-xs text-gray-600">{tip}</span>
                          </li>
                        ))}
                      </ul>
                    </div>

                    {/* Generate Images CTA for Paid Plans */}
                    <div className="mt-4 pt-4 border-t">
                      <Button 
                        variant="outline" 
                        size="sm" 
                        className="w-full bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200 text-purple-700 hover:from-purple-100 hover:to-pink-100"
                      >
                        <Crown className="h-4 w-4 mr-2" />
                        Generate Images (Pro Plan)
                      </Button>
                    </div>
                  </CardContent>
                </Card>
              ))}
            </div>
          </div>

          {/* Bullet Points Optimization Strategy */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Bullet Points Optimization Strategy</h3>
            <Card>
              <CardContent className="p-6">
                <div className="space-y-6">
                  <div>
                    <h4 className="font-semibold text-gray-900 mb-3">Optimized Bullet Point Structure</h4>
                    <ul className="space-y-3">
                      <li className="flex items-start">
                        <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-bold text-blue-700 mr-3 mt-0.5">1</div>
                        <div>
                          <p className="font-medium text-gray-900">Feature + Benefit Format</p>
                          <p className="text-sm text-gray-600 mt-1">BLUETOOTH 5.0 TECHNOLOGY - Stream music wirelessly up to 45 feet while enjoying crystal-clear audio quality for uninterrupted sleep</p>
                        </div>
                      </li>
                      <li className="flex items-start">
                        <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-bold text-blue-700 mr-3 mt-0.5">2</div>
                        <div>
                          <p className="font-medium text-gray-900">Address Pain Points</p>
                          <p className="text-sm text-gray-600 mt-1">SIDE SLEEPER FRIENDLY - Ultra-thin 0.25" speakers eliminate ear pressure, perfect for all sleep positions including side sleepers</p>
                        </div>
                      </li>
                      <li className="flex items-start">
                        <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-bold text-blue-700 mr-3 mt-0.5">3</div>
                        <div>
                          <p className="font-medium text-gray-900">Include Social Proof</p>
                          <p className="text-sm text-gray-600 mt-1">TRUSTED BY 50,000+ CUSTOMERS - Join thousands who've improved their sleep quality with our award-winning design</p>
                        </div>
                      </li>
                      <li className="flex items-start">
                        <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-bold text-blue-700 mr-3 mt-0.5">4</div>
                        <div>
                          <p className="font-medium text-gray-900">Highlight Unique Value</p>
                          <p className="text-sm text-gray-600 mt-1">10-HOUR BATTERY LIFE - Sleep through the night with extended playtime, 2X longer than competing brands</p>
                        </div>
                      </li>
                      <li className="flex items-start">
                        <div className="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-sm font-bold text-blue-700 mr-3 mt-0.5">5</div>
                        <div>
                          <p className="font-medium text-gray-900">Risk Reversal</p>
                          <p className="text-sm text-gray-600 mt-1">90-DAY GUARANTEE - Love your sleep transformation or get a full refund, no questions asked</p>
                        </div>
                      </li>
                    </ul>
                  </div>
                  
                  <div className="bg-gray-50 p-4 rounded-lg">
                    <h5 className="font-medium text-gray-900 mb-2">Key Optimization Tips:</h5>
                    <ul className="space-y-2 text-sm text-gray-600">
                      <li> Start with your strongest feature/benefit combination</li>
                      <li> Use ALL CAPS for the feature, followed by a dash and the benefit</li>
                      <li> Include specific numbers and data points when possible</li>
                      <li> Address the top 3 customer pain points from reviews</li>
                      <li> End with a guarantee or risk reversal statement</li>
                    </ul>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* A+ Content Optimization Strategy */}
          <div className="mb-12">
            <h3 className="text-2xl font-bold text-gray-900 mb-6">A+ Content Optimization Strategy</h3>
            <Card>
              <CardContent className="p-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <div>
                    <h4 className="font-semibold text-gray-900 mb-3">Module Recommendations</h4>
                    <div className="space-y-3">
                      <div className="p-3 bg-blue-50 rounded-lg">
                        <h5 className="font-medium text-blue-900">1. Hero Image with Overlay Text</h5>
                        <p className="text-sm text-blue-700 mt-1">Lifestyle image showing product in use with key benefit overlay</p>
                      </div>
                      <div className="p-3 bg-green-50 rounded-lg">
                        <h5 className="font-medium text-green-900">2. Comparison Chart</h5>
                        <p className="text-sm text-green-700 mt-1">Feature comparison against 3-4 competitors highlighting advantages</p>
                      </div>
                      <div className="p-3 bg-purple-50 rounded-lg">
                        <h5 className="font-medium text-purple-900">3. Technical Specifications</h5>
                        <p className="text-sm text-purple-700 mt-1">Detailed specs with icons for visual appeal</p>
                      </div>
                      <div className="p-3 bg-orange-50 rounded-lg">
                        <h5 className="font-medium text-orange-900">4. Customer Journey Module</h5>
                        <p className="text-sm text-orange-700 mt-1">Before/after scenarios showing transformation</p>
                      </div>
                      <div className="p-3 bg-pink-50 rounded-lg">
                        <h5 className="font-medium text-pink-900">5. Brand Story</h5>
                        <p className="text-sm text-pink-700 mt-1">Build trust with company background and mission</p>
                      </div>
                    </div>
                  </div>
                  
                  <div>
                    <h4 className="font-semibold text-gray-900 mb-3">Content Guidelines</h4>
                    <div className="space-y-4">
                      <div>
                        <h5 className="text-sm font-medium text-gray-700 mb-2">Visual Style:</h5>
                        <ul className="space-y-1 text-sm text-gray-600">
                          <li> Consistent color scheme matching brand</li>
                          <li> High-resolution lifestyle photography</li>
                          <li> Clean, modern typography</li>
                          <li> 16:9 aspect ratio for all images</li>
                        </ul>
                      </div>
                      
                      <div>
                        <h5 className="text-sm font-medium text-gray-700 mb-2">Copy Guidelines:</h5>
                        <ul className="space-y-1 text-sm text-gray-600">
                          <li> Short, scannable paragraphs (3-4 lines max)</li>
                          <li> Benefit-focused headlines</li>
                          <li> Include social proof elements</li>
                          <li> Mobile-optimized text size</li>
                        </ul>
                      </div>
                      
                      <div>
                        <h5 className="text-sm font-medium text-gray-700 mb-2">SEO Optimization:</h5>
                        <ul className="space-y-1 text-sm text-gray-600">
                          <li> Include target keywords naturally</li>
                          <li> Alt text for all images</li>
                          <li> Descriptive module titles</li>
                          <li> Link to brand store when possible</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Video Optimization Strategy */}
          <div>
            <h3 className="text-2xl font-bold text-gray-900 mb-6">Video Optimization Strategy</h3>
            <Card>
              <CardContent className="p-6">
                <div className="space-y-6">
                  <div>
                    <h4 className="font-semibold text-gray-900 mb-3">Recommended Video Types</h4>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div className="p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg">
                        <h5 className="font-medium text-blue-900 mb-2">Product Demo (30s)</h5>
                        <ul className="space-y-1 text-sm text-blue-700">
                          <li> Show product in use</li>
                          <li> Highlight key features</li>
                          <li> Multiple angles</li>
                          <li> No audio needed</li>
                        </ul>
                      </div>
                      <div className="p-4 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg">
                        <h5 className="font-medium text-green-900 mb-2">Lifestyle Video (45s)</h5>
                        <ul className="space-y-1 text-sm text-green-700">
                          <li> Real-world scenarios</li>
                          <li> Target audience actors</li>
                          <li> Problem/solution format</li>
                          <li> Emotional connection</li>
                        </ul>
                      </div>
                      <div className="p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg">
                        <h5 className="font-medium text-purple-900 mb-2">Unboxing Video (60s)</h5>
                        <ul className="space-y-1 text-sm text-purple-700">
                          <li> Premium feel</li>
                          <li> Show all contents</li>
                          <li> Setup instructions</li>
                          <li> First impressions</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  
                  <div>
                    <h4 className="font-semibold text-gray-900 mb-3">Video Production Guidelines</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div>
                        <h5 className="text-sm font-medium text-gray-700 mb-2">Technical Specifications:</h5>
                        <ul className="space-y-1 text-sm text-gray-600">
                          <li> Resolution: 1920x1080 minimum</li>
                          <li> Format: MP4, H.264 codec</li>
                          <li> Frame rate: 30fps</li>
                          <li> File size: Under 500MB</li>
                          <li> Aspect ratio: 16:9</li>
                        </ul>
                      </div>
                      <div>
                        <h5 className="text-sm font-medium text-gray-700 mb-2">Content Best Practices:</h5>
                        <ul className="space-y-1 text-sm text-gray-600">
                          <li> Start with product in first 3 seconds</li>
                          <li> Include text overlays for key features</li>
                          <li> Show scale with hands/common objects</li>
                          <li> End with clear CTA or brand logo</li>
                          <li> Optimize for silent viewing</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  
                  <div className="bg-yellow-50 p-4 rounded-lg">
                    <div className="flex items-start">
                      <Lightbulb className="h-5 w-5 text-yellow-600 mr-2 mt-0.5" />
                      <div>
                        <h5 className="font-medium text-yellow-900 mb-1">Pro Tip: Video Placement Strategy</h5>
                        <p className="text-sm text-yellow-800">Place your main product demo video in the second image slot for maximum visibility. Use lifestyle videos in image slots 6-7 to maintain engagement throughout the gallery.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>
            </div>
          </section>
        )}

        {/* Financial & Launch Strategy Section */}
        {activeTab === 'financial' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div className="text-center mb-12">
                <h2 className="text-3xl font-bold text-gray-900 mb-4">Launch Strategy</h2>
                <p className="text-lg text-gray-600">Strategic launch roadmap and timeline</p>
              </div>

          {/* AI Brief */}
          <div className="mb-12">
            <Card className="bg-gradient-to-r from-green-50 to-teal-50 border-green-200">
              <CardContent className="p-6">
                <div className="flex items-start space-x-4">
                  <div className="p-3 bg-green-100 rounded-full">
                    <Sparkles className="h-6 w-6 text-green-600" />
                  </div>
                  <div>
                    <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Launch Intelligence</h3>
                    <p className="text-gray-700 mb-4">
                      Strong financial outlook with 35% profit margins achievable at optimal COGS levels. $52K monthly revenue potential 
                      with 1,735 units suggests healthy market demand. Interactive COGS calculator reveals break-even at 45% cost ratio, 
                      providing excellent margin buffer for premium positioning and marketing investment.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <Badge className="bg-green-100 text-green-800">High Margins</Badge>
                      <Badge className="bg-blue-100 text-blue-800">Strong ROI</Badge>
                      <Badge className="bg-purple-100 text-purple-800">Scalable Model</Badge>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

            
            {/* Profit Calculator with COGS Slider */}
            <div className="mb-8">
              <Card>
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <DollarSign className="h-5 w-5 text-green-600" />
                    Profit Calculator
                  </CardTitle>
                  <CardDescription>Interactive profit analysis with adjustable costs</CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    {/* COGS Slider */}
                    <div className="lg:col-span-1">
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Cost of Goods Sold (COGS)
                      </label>
                      <div className="space-y-2">
                        <input
                          type="range"
                          min="4"
                          max="15"
                          step="0.25"
                          className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                          style={{
                            background: `linear-gradient(to right, #dc2626 0%, #fbbf24 50%, #16a34a 100%)`
                          }}
                        />
                        <div className="flex justify-between text-xs text-gray-500">
                          <span>$4.00</span>
                          <span className="font-medium text-gray-900">$8.50 (35%)</span>
                          <span>$15.00</span>
                        </div>
                      </div>
                      
                      <div className="mt-4 space-y-2 text-sm">
                        <div className="flex justify-between">
                          <span className="text-gray-600">Manufacturing:</span>
                          <span className="font-medium">$6.20</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-gray-600">Materials:</span>
                          <span className="font-medium">$1.80</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-gray-600">Packaging:</span>
                          <span className="font-medium">$0.50</span>
                        </div>
                        <div className="flex justify-between border-t pt-2 font-medium">
                          <span>Total COGS:</span>
                          <span>$8.50</span>
                        </div>
                      </div>
                    </div>

                    {/* Financial Metrics */}
                    <div className="lg:col-span-2">
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div className="text-center p-4 bg-blue-50 rounded-lg">
                          <div className="text-2xl font-bold text-blue-600">$23.99</div>
                          <div className="text-sm text-gray-600">Selling Price</div>
                        </div>
                        <div className="text-center p-4 bg-red-50 rounded-lg">
                          <div className="text-2xl font-bold text-red-600">$8.50</div>
                          <div className="text-sm text-gray-600">COGS</div>
                        </div>
                        <div className="text-center p-4 bg-green-50 rounded-lg">
                          <div className="text-2xl font-bold text-green-600">$15.49</div>
                          <div className="text-sm text-gray-600">Gross Profit</div>
                        </div>
                        <div className="text-center p-4 bg-purple-50 rounded-lg">
                          <div className="text-2xl font-bold text-purple-600">65%</div>
                          <div className="text-sm text-gray-600">Margin</div>
                        </div>
                      </div>

                      {/* Break-even Analysis */}
                      <div className="bg-gray-50 p-4 rounded-lg">
                        <h4 className="font-semibold text-gray-900 mb-3">Break-even Analysis</h4>
                        <div className="grid grid-cols-3 gap-4 text-sm">
                          <div>
                            <div className="text-gray-600">Break-even Units:</div>
                            <div className="font-bold text-gray-900">324 units</div>
                          </div>
                          <div>
                            <div className="text-gray-600">Break-even Revenue:</div>
                            <div className="font-bold text-gray-900">$7,776</div>
                          </div>
                          <div>
                            <div className="text-gray-600">Time to Break-even:</div>
                            <div className="font-bold text-gray-900">6 days</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </div>

            {/* Original keywords section temporarily kept - to be replaced */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
              
              {/* Primary Keywords */}
              <Card>
                <CardHeader>
                  <CardTitle className="text-emerald-700">Primary Keywords</CardTitle>
                  <CardDescription>Launch phase targets</CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="space-y-3">
                        <div className="p-3 bg-emerald-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">bluetooth sleep mask</span>
                            <Badge variant="outline" className="text-xs">68/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            45K searches  $1.23 CPC  12.5% CVR
                          </div>
                        </div>
                        <div className="p-3 bg-emerald-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">wireless sleep headphones</span>
                            <Badge variant="outline" className="text-xs">62/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            28K searches  $1.05 CPC  11.8% CVR
                          </div>
                        </div>
                        <div className="p-3 bg-emerald-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">sleep mask with speakers</span>
                            <Badge variant="outline" className="text-xs">58/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            18K searches  $0.98 CPC  12.2% CVR
                          </div>
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  {/* Secondary Keywords */}
                  <Card>
                    <CardHeader>
                      <CardTitle className="text-blue-700">Secondary Keywords</CardTitle>
                      <CardDescription>Expansion phase</CardDescription>
                    </CardHeader>
                    <CardContent>
                      <div className="space-y-3">
                        <div className="p-3 bg-blue-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">sleep headphones side sleeper</span>
                            <Badge variant="outline" className="text-xs">48/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            12K searches  $0.95 CPC  11.5% CVR
                          </div>
                        </div>
                        <div className="p-3 bg-blue-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">bluetooth headband sleep</span>
                            <Badge variant="outline" className="text-xs">45/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            8K searches  $0.88 CPC  10.8% CVR
                          </div>
                        </div>
                        <div className="p-3 bg-blue-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">comfortable sleep mask</span>
                            <Badge variant="outline" className="text-xs">40/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            6K searches  $0.82 CPC  10.2% CVR
                          </div>
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  {/* Long-tail Keywords */}
                  <Card>
                    <CardHeader>
                      <CardTitle className="text-purple-700">Long-tail Keywords</CardTitle>
                      <CardDescription>Quick wins</CardDescription>
                    </CardHeader>
                    <CardContent>
                      <div className="space-y-3">
                        <div className="p-3 bg-purple-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">ultra thin sleep mask bluetooth</span>
                            <Badge variant="outline" className="text-xs">25/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            2K searches  $0.65 CPC  13.5% CVR
                          </div>
                        </div>
                        <div className="p-3 bg-purple-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">10 hour battery sleep mask</span>
                            <Badge variant="outline" className="text-xs">20/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            1.5K searches  $0.58 CPC  14.2% CVR
                          </div>
                        </div>
                        <div className="p-3 bg-purple-50 rounded-lg">
                          <div className="flex justify-between items-center mb-1">
                            <span className="font-medium text-sm">washable bluetooth sleep mask</span>
                            <Badge variant="outline" className="text-xs">18/100</Badge>
                          </div>
                          <div className="text-xs text-gray-600">
                            1K searches  $0.52 CPC  13.8% CVR
                          </div>
                        </div>
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </div>

              {/* Amazon Search Results Simulation */}
              <div className="mb-12">
                <h3 className="text-2xl font-bold text-gray-900 mb-6">Amazon Search Results Simulation</h3>
                <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                  {/* Amazon Header */}
                  <div className="bg-[#131921] p-3">
                    <div className="flex items-center gap-4">
                      <div className="text-white font-bold text-xl">amazon</div>
                      <div className="flex-1">
                        <div className="flex">
                          <select className="px-3 py-2 text-sm bg-gray-100 border-0 rounded-l">
                            <option>All</option>
                          </select>
                          <input 
                            type="text" 
                            value="bluetooth sleep mask" 
                            readOnly
                            className="flex-1 px-3 py-2 text-sm border-0 bg-white"
                          />
                          <button className="bg-[#febd69] px-6 py-2 rounded-r">
                            <Search className="h-5 w-5 text-gray-800" />
                          </button>
                        </div>
                      </div>
                      <div className="text-white text-sm">Returns & Orders</div>
                      <div className="text-white flex items-center">
                        <span className="text-xs">0</span>
                        <div className="ml-1 text-2xl"></div>
                      </div>
                    </div>
                  </div>

                  {/* Category Navigation */}
                  <div className="bg-gray-100 px-4 py-2 text-xs flex items-center gap-2 border-b">
                    <span className="hover:text-orange-700 cursor-pointer">All</span>
                    <span></span>
                    <span className="hover:text-orange-700 cursor-pointer">Health & Personal Care</span>
                    <span></span>
                    <span className="hover:text-orange-700 cursor-pointer">Sleep & Snoring</span>
                    <span></span>
                    <span className="font-medium">Sleep Masks</span>
                  </div>

                  {/* Results count bar */}
                  <div className="px-4 py-2 text-sm text-gray-700 border-b">
                    1-48 of over 3,000 results for <span className="text-orange-700 font-medium">"bluetooth sleep mask"</span>
                  </div>

                  {/* Main content */}
                  <div className="flex">
                    {/* Sidebar */}
                    <div className="w-56 p-4 bg-white">
                      <div className="space-y-6">
                        {/* Category */}
                        <div>
                          <h3 className="font-bold text-sm mb-3 text-gray-900">Health & Personal Care</h3>
                          <ul className="space-y-1 text-sm">
                            <li className="hover:text-orange-700 cursor-pointer pl-3">Sleep & Snoring</li>
                            <li className="hover:text-orange-700 cursor-pointer pl-6 text-orange-700 font-medium">Sleep Masks</li>
                            <li className="hover:text-orange-700 cursor-pointer pl-3">Personal Care</li>
                            <li className="hover:text-orange-700 cursor-pointer pl-3">Medical Supplies</li>
                          </ul>
                        </div>

                        <div>
                          <h4 className="font-bold text-sm mb-2">Customer Reviews</h4>
                          <div className="space-y-1">
                            <div className="flex items-center text-sm hover:text-orange-700 cursor-pointer">
                              <div className="flex text-orange-400">
                                {''.split('').map((star, i) => (
                                  <span key={i}>{star}</span>
                                ))}
                              </div>
                              <span className="ml-1 text-xs">& Up</span>
                            </div>
                          </div>
                        </div>
                        
                        <div>
                          <h4 className="font-bold text-sm mb-2">Price</h4>
                          <div className="space-y-1 text-sm">
                            <div className="hover:text-orange-700 cursor-pointer">Under $25</div>
                            <div className="hover:text-orange-700 cursor-pointer">$25 to $50</div>
                          </div>
                        </div>

                        <div>
                          <h4 className="font-bold text-sm mb-2">Brands</h4>
                          <div className="space-y-1 text-sm">
                            <label className="flex items-center cursor-pointer hover:text-orange-700">
                              <input type="checkbox" className="mr-2" />
                              <span>MUSICOZY</span>
                            </label>
                            <label className="flex items-center cursor-pointer hover:text-orange-700">
                              <input type="checkbox" className="mr-2" />
                              <span>LC-dolida</span>
                            </label>
                            <label className="flex items-center cursor-pointer hover:text-orange-700">
                              <input type="checkbox" className="mr-2" />
                              <span>CozyPhones</span>
                            </label>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Products Grid */}
                    <div className="flex-1 p-4 bg-gray-50">
                      <div>
                        {/* Sort Bar */}
                        <div className="flex justify-between items-center mb-4">
                          <span className="text-sm text-gray-600">Sort by: <select className="border rounded px-2 py-1"><option>Featured</option></select></span>
                        </div>

                        {/* Products Grid - 5 per row */}
                        <div className="grid grid-cols-5 gap-4">
                          {[
                            { position: 1, name: "MUSICOZY Sleep Headphones Bluetooth Sports Headband, Wireless Music Sleeping Headphones", rating: 4.4, reviews: 28453, price: 25.99, oldPrice: 39.99, prime: true, sponsored: false, coupon: "Save $5.00 with coupon" },
                            { position: 2, name: "LC-dolida Sleep Mask with Bluetooth Headphones, 3D Eye Mask for Sleeping", rating: 4.3, reviews: 15234, price: 22.99, oldPrice: 32.99, prime: true, sponsored: false },
                            { position: 3, name: "CozyPhones Sleep Headphones & Travel Bag, Ultra Thin Speakers", rating: 4.0, reviews: 8934, price: 19.95, prime: true, sponsored: false },
                            { position: 4, name: "Smart Bluetooth Sleep Mask with Built-in Ultra Thin HD Speakers - 10 Hour Battery", rating: 4.5, reviews: 50, price: 29.99, oldPrice: 49.99, prime: true, sponsored: false, isYours: true },
                            { position: 5, name: "Perytong Sleep Headphones Wireless, Bluetooth Sports Headband", rating: 4.2, reviews: 6234, price: 24.99, prime: true, sponsored: false },
                            
                            { position: 6, name: "Lightimetunnel Sleep Mask Bluetooth Headphones for Side Sleepers", rating: 4.1, reviews: 4532, price: 27.99, oldPrice: 35.99, prime: true, sponsored: false },
                            { position: 7, name: "TOPOINT Bluetooth Sleep Mask, Wireless Music Eye Mask", rating: 4.0, reviews: 3421, price: 21.99, prime: true, sponsored: false },
                            { position: 8, name: "Joseche Wireless Bluetooth Sleeping Mask Headphones", rating: 3.9, reviews: 2156, price: 18.99, prime: true, sponsored: false },
                            { position: 9, name: "WINONLY Sleep Headphones Bluetooth Headband", rating: 4.2, reviews: 5678, price: 23.99, prime: true, sponsored: false },
                            { position: 10, name: "Lavince Sleep Headphones Bluetooth Sports Headband", rating: 4.1, reviews: 4321, price: 26.99, prime: true, sponsored: false }
                          ].map((product) => (
                            <div 
                              key={product.position} 
                              className={`bg-white p-4 ${
                                product.isYours 
                                  ? 'ring-2 ring-emerald-500 relative shadow-lg' 
                                  : ''
                              }`}
                            >
                              {product.isYours && (
                                <div className="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-emerald-600 text-white text-xs px-3 py-1 rounded-full z-10">
                                  Your Product
                                </div>
                              )}
                              
                              {/* Product Image */}
                              <div className="w-full h-48 bg-gray-100 mb-3 flex items-center justify-center">
                                {product.isYours ? (
                                  <div className="text-center">
                                    <Crown className="h-16 w-16 text-emerald-600 mx-auto mb-2" />
                                    <span className="text-xs text-gray-600">Your Product</span>
                                  </div>
                                ) : (
                                  <div className="w-full h-full bg-gray-200"></div>
                                )}
                              </div>
                              
                              <h3 className="text-sm text-[#0066c0] hover:text-orange-700 hover:underline cursor-pointer font-normal line-clamp-3 mb-2">
                                {product.name}
                              </h3>
                              
                              {/* Rating */}
                              <div className="flex items-center mb-1">
                                <div className="flex text-orange-400 text-xs">
                                  {[...Array(5)].map((_, i) => (
                                    <span key={i}>{i < Math.floor(product.rating) ? '' : ''}</span>
                                  ))}
                                </div>
                                <span className="text-[#0066c0] text-xs ml-1 hover:text-orange-700 hover:underline cursor-pointer">
                                  {product.reviews.toLocaleString()}
                                </span>
                              </div>

                              {/* Price */}
                              <div className="mb-1">
                                <span className="text-xl font-normal">${product.price}</span>
                                {product.oldPrice && (
                                  <span className="text-xs text-gray-500 line-through ml-1">
                                    ${product.oldPrice}
                                  </span>
                                )}
                              </div>

                              {/* Coupon */}
                              {product.coupon && (
                                <div className="text-xs text-green-700 mb-1">{product.coupon}</div>
                              )}

                              {/* Prime */}
                              {product.prime && (
                                <div className="mb-2">
                                  <span className="text-[#0066c0] font-bold text-xs">prime</span>
                                  <span className="text-xs text-gray-700 ml-1">
                                    FREE delivery
                                  </span>
                                </div>
                              )}

                              {/* Add to Cart Button */}
                              <button className="w-full bg-[#FFD814] hover:bg-[#F7CA00] border border-[#FCD200] rounded-lg py-1 text-xs mt-2">
                                Add to Cart
                              </button>

                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Bottom Success Metrics */}
                  <div className="bg-gray-50 p-6 border-t">
                    <h4 className="font-semibold text-gray-900 mb-4">Launch Positioning Analysis</h4>
                    
                    {/* Review Analysis */}
                    <div className="mb-6">
                      <h5 className="font-semibold text-gray-800 mb-3">Review Benchmarks</h5>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <Card>
                          <CardContent className="p-4">
                            <div className="text-center">
                              <div className="text-3xl font-bold text-blue-600">15,234</div>
                              <p className="text-sm text-gray-600 mt-1">Median Reviews (Top 5)</p>
                              <div className="mt-3 p-3 bg-blue-50 rounded">
                                <p className="text-xs text-blue-800">Time to Match: ~18 months</p>
                                <p className="text-xs text-blue-700 mt-1">761,700 sales needed (2% review rate)</p>
                              </div>
                            </div>
                          </CardContent>
                        </Card>
                        
                        <Card>
                          <CardContent className="p-4">
                            <div className="text-center">
                              <div className="text-3xl font-bold text-purple-600">4.2</div>
                              <p className="text-sm text-gray-600 mt-1">Minimum Rating Required</p>
                              <div className="mt-3 p-3 bg-purple-50 rounded">
                                <p className="text-xs text-purple-800">Must maintain 4.2+ stars</p>
                                <p className="text-xs text-purple-700 mt-1">Quality control critical</p>
                              </div>
                            </div>
                          </CardContent>
                        </Card>
                        
                        <Card>
                          <CardContent className="p-4">
                            <div className="text-center">
                              <div className="text-3xl font-bold text-green-600">50-100</div>
                              <p className="text-sm text-gray-600 mt-1">Initial Review Target</p>
                              <div className="mt-3 p-3 bg-green-50 rounded">
                                <p className="text-xs text-green-800">2,500-5,000 sales</p>
                                <p className="text-xs text-green-700 mt-1">Achievable in 60-90 days</p>
                              </div>
                            </div>
                          </CardContent>
                        </Card>
                      </div>
                    </div>
                    
                    {/* Pricing Strategy */}
                    <div className="mb-6">
                      <h5 className="font-semibold text-gray-800 mb-3">Dynamic Pricing Strategy</h5>
                      <Card>
                        <CardContent className="p-4">
                          <div className="space-y-4">
                            {/* Price Timeline */}
                            <div className="grid grid-cols-4 gap-4">
                              <div className="text-center p-3 bg-red-50 rounded-lg">
                                <p className="text-sm font-semibold text-red-700">Launch Price</p>
                                <p className="text-2xl font-bold text-red-800">$19.99</p>
                                <p className="text-xs text-red-600">0-50 reviews</p>
                                <p className="text-xs text-gray-600 mt-1">35% below competitors</p>
                              </div>
                              <div className="text-center p-3 bg-orange-50 rounded-lg">
                                <p className="text-sm font-semibold text-orange-700">Growth Price</p>
                                <p className="text-2xl font-bold text-orange-800">$24.99</p>
                                <p className="text-xs text-orange-600">50-200 reviews</p>
                                <p className="text-xs text-gray-600 mt-1">15% below competitors</p>
                              </div>
                              <div className="text-center p-3 bg-yellow-50 rounded-lg">
                                <p className="text-sm font-semibold text-yellow-700">Mature Price</p>
                                <p className="text-2xl font-bold text-yellow-800">$27.99</p>
                                <p className="text-xs text-yellow-600">200-500 reviews</p>
                                <p className="text-xs text-gray-600 mt-1">5% below competitors</p>
                              </div>
                              <div className="text-center p-3 bg-green-50 rounded-lg">
                                <p className="text-sm font-semibold text-green-700">Target Price</p>
                                <p className="text-2xl font-bold text-green-800">$29.99</p>
                                <p className="text-xs text-green-600">500+ reviews</p>
                                <p className="text-xs text-gray-600 mt-1">Premium positioning</p>
                              </div>
                            </div>
                            
                            <div className="mt-4 p-4 bg-blue-50 rounded-lg">
                              <p className="text-sm text-blue-800">
                                <strong>Strategy:</strong> Start 35% below competitor average ($30.99) to compensate for low social proof. 
                                Gradually increase price as reviews accumulate. Each 50 reviews earned allows ~$2-3 price increase while maintaining conversion rates.
                              </p>
                            </div>
                          </div>
                        </CardContent>
                      </Card>
                    </div>
                    
                    {/* Sales Forecast with COGS Calculator */}
                    <div>
                      <h5 className="font-semibold text-gray-800 mb-3">Launch Sales & Profit Forecast</h5>
                      <Card>
                        <CardContent className="p-4">
                          <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              Adjust COGS to see profit projections: {cogsPercentage}%
                            </label>
                            <input
                              type="range"
                              min="20"
                              max="50"
                              value={cogsPercentage}
                              onChange={(e) => setCogsPercentage(Number(e.target.value))}
                              className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                            />
                            <div className="flex justify-between text-sm text-gray-500 mt-1">
                              <span>20% (High Margin)</span>
                              <span>35% (Average)</span>
                              <span>50% (Low Margin)</span>
                            </div>
                          </div>
                          
                          <div className="grid grid-cols-4 gap-4">
                            <div className="text-center p-3 bg-gray-50 rounded">
                              <p className="text-xs text-gray-600">Month 1-2</p>
                              <p className="text-sm font-semibold">Launch Phase</p>
                              <p className="text-xs text-gray-600 mt-1">Price: $19.99</p>
                              <p className="text-xs">50 sales/day</p>
                              <p className="text-sm font-bold text-green-600 mt-1">
                                ${((19.99 - (19.99 * cogsPercentage / 100) - 8.50) * 50 * 30).toFixed(0)}/mo profit
                              </p>
                            </div>
                            <div className="text-center p-3 bg-gray-50 rounded">
                              <p className="text-xs text-gray-600">Month 3-4</p>
                              <p className="text-sm font-semibold">Growth Phase</p>
                              <p className="text-xs text-gray-600 mt-1">Price: $24.99</p>
                              <p className="text-xs">75 sales/day</p>
                              <p className="text-sm font-bold text-green-600 mt-1">
                                ${((24.99 - (24.99 * cogsPercentage / 100) - 8.50) * 75 * 30).toFixed(0)}/mo profit
                              </p>
                            </div>
                            <div className="text-center p-3 bg-gray-50 rounded">
                              <p className="text-xs text-gray-600">Month 5-6</p>
                              <p className="text-sm font-semibold">Scale Phase</p>
                              <p className="text-xs text-gray-600 mt-1">Price: $27.99</p>
                              <p className="text-xs">100 sales/day</p>
                              <p className="text-sm font-bold text-green-600 mt-1">
                                ${((27.99 - (27.99 * cogsPercentage / 100) - 8.50) * 100 * 30).toFixed(0)}/mo profit
                              </p>
                            </div>
                            <div className="text-center p-3 bg-gray-50 rounded">
                              <p className="text-xs text-gray-600">Month 7+</p>
                              <p className="text-sm font-semibold">Mature Phase</p>
                              <p className="text-xs text-gray-600 mt-1">Price: $29.99</p>
                              <p className="text-xs">120 sales/day</p>
                              <p className="text-sm font-bold text-green-600 mt-1">
                                ${((29.99 - (29.99 * cogsPercentage / 100) - 8.50) * 120 * 30).toFixed(0)}/mo profit
                              </p>
                            </div>
                          </div>
                          
                          <div className="mt-4 grid grid-cols-3 gap-4">
                            <div className="p-3 bg-blue-50 rounded text-center">
                              <p className="text-sm font-semibold text-blue-700">Year 1 Revenue</p>
                              <p className="text-xl font-bold text-blue-900">$1.8M</p>
                            </div>
                            <div className="p-3 bg-green-50 rounded text-center">
                              <p className="text-sm font-semibold text-green-700">Year 1 Profit</p>
                              <p className="text-xl font-bold text-green-900">
                                ${(1800000 * (1 - cogsPercentage / 100 - 0.35)).toFixed(0)}
                              </p>
                            </div>
                            <div className="p-3 bg-purple-50 rounded text-center">
                              <p className="text-sm font-semibold text-purple-700">ROI</p>
                              <p className="text-xl font-bold text-purple-900">
                                {((1800000 * (1 - cogsPercentage / 100 - 0.35) / 30000 * 100)).toFixed(0)}%
                              </p>
                            </div>
                          </div>
                        </CardContent>
                      </Card>
                    </div>
                  </div>
                </div>
              </div>

              {/* Launch Timeline & Milestones */}
              <div>
                <h3 className="text-2xl font-bold text-gray-900 mb-6">Launch Roadmap</h3>
                <Card>
                  <CardContent className="p-6">
                    <div className="space-y-6">
                      {/* Week 1-2 */}
                      <div className="flex items-start">
                        <div className="w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center flex-shrink-0">
                          <span className="text-sm font-bold text-emerald-700">W1-2</span>
                        </div>
                        <div className="ml-4 flex-1">
                          <h4 className="font-semibold text-gray-900">Pre-Launch Preparation</h4>
                          <p className="text-sm text-gray-600 mt-1">Optimize listing for primary keywords, set up auto campaigns, prepare inventory</p>
                          <div className="mt-2 flex flex-wrap gap-2">
                            <Badge variant="outline" className="text-xs">50 units/day capacity</Badge>
                            <Badge variant="outline" className="text-xs">$150/day PPC budget</Badge>
                          </div>
                        </div>
                      </div>

                      {/* Week 3-4 */}
                      <div className="flex items-start">
                        <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                          <span className="text-sm font-bold text-blue-700">W3-4</span>
                        </div>
                        <div className="ml-4 flex-1">
                          <h4 className="font-semibold text-gray-900">Soft Launch Phase</h4>
                          <p className="text-sm text-gray-600 mt-1">Target long-tail keywords, gather initial reviews, monitor ACoS</p>
                          <div className="mt-2 flex flex-wrap gap-2">
                            <Badge variant="outline" className="text-xs">Target: 10-15 reviews</Badge>
                            <Badge variant="outline" className="text-xs">60-80% ACoS expected</Badge>
                          </div>
                        </div>
                      </div>

                      {/* Week 5-8 */}
                      <div className="flex items-start">
                        <div className="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0">
                          <span className="text-sm font-bold text-purple-700">W5-8</span>
                        </div>
                        <div className="ml-4 flex-1">
                          <h4 className="font-semibold text-gray-900">Scale & Optimize</h4>
                          <p className="text-sm text-gray-600 mt-1">Expand to primary keywords, increase daily budget, optimize bids</p>
                          <div className="mt-2 flex flex-wrap gap-2">
                            <Badge variant="outline" className="text-xs">Target: 50+ reviews</Badge>
                            <Badge variant="outline" className="text-xs">Page 1 for 3 keywords</Badge>
                          </div>
                        </div>
                      </div>

                      {/* Week 9+ */}
                      <div className="flex items-start">
                        <div className="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">
                          <span className="text-sm font-bold text-orange-700">W9+</span>
                        </div>
                        <div className="ml-4 flex-1">
                          <h4 className="font-semibold text-gray-900">Growth & Expansion</h4>
                          <p className="text-sm text-gray-600 mt-1">Launch variations, optimize for profitability, build brand presence</p>
                          <div className="mt-2 flex flex-wrap gap-2">
                            <Badge variant="outline" className="text-xs">25-35% target ACoS</Badge>
                            <Badge variant="outline" className="text-xs">100+ reviews</Badge>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>
          </section>
        )}

        {/* Financial Analysis Section */}
        {activeTab === 'financial-analysis' && (
          <section className="py-16 bg-gray-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div className="text-center mb-12">
                <h2 className="text-3xl font-bold text-gray-900 mb-4">Financial Analysis</h2>
                <p className="text-lg text-gray-600">Comprehensive profit analysis and financial projections</p>
              </div>

              {/* AI Brief */}
              <div className="mb-12">
                <Card className="bg-gradient-to-r from-green-50 to-emerald-50 border-green-200">
                  <CardContent className="p-6">
                    <div className="flex items-start space-x-4">
                      <div className="p-3 bg-green-100 rounded-full">
                        <Sparkles className="h-6 w-6 text-green-600" />
                      </div>
                      <div>
                        <h3 className="text-lg font-semibold text-gray-900 mb-2">AI Financial Intelligence</h3>
                        <p className="text-gray-700 mb-4">
                          Strong financial outlook with 35% profit margins achievable at optimal COGS levels. $52K monthly revenue potential 
                          with 1,735 units suggests healthy market demand. Interactive COGS calculator reveals break-even at 45% cost ratio, 
                          while FBA fee optimization could save $2,776 monthly through packaging improvements.
                        </p>
                        <div className="flex flex-wrap gap-2">
                          <Badge className="bg-green-100 text-green-800">Strong Margins</Badge>
                          <Badge className="bg-blue-100 text-blue-800">Revenue Potential</Badge>
                          <Badge className="bg-purple-100 text-purple-800">Cost Optimization</Badge>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>

              {/* This is where the Financial Analysis content will be moved from Launch Strategy */}
              {/* Profit Calculator with COGS Slider */}
              <div className="mb-8">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <DollarSign className="h-5 w-5 text-green-600" />
                      Profit Calculator
                    </CardTitle>
                    <CardDescription>Interactive profit analysis with adjustable costs</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                      {/* COGS Slider */}
                      <div className="lg:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Cost of Goods Sold (COGS)
                        </label>
                        <div className="space-y-2">
                          <input
                            type="range"
                            min="4"
                            max="15"
                            step="0.25"
                            className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                            style={{
                              background: `linear-gradient(to right, #dc2626 0%, #fbbf24 50%, #16a34a 100%)`
                            }}
                          />
                          <div className="flex justify-between text-xs text-gray-500">
                            <span>$4.00</span>
                            <span className="font-medium text-gray-900">$8.50 (35%)</span>
                            <span>$15.00</span>
                          </div>
                        </div>
                        
                        <div className="mt-4 space-y-2 text-sm">
                          <div className="flex justify-between">
                            <span className="text-gray-600">Manufacturing:</span>
                            <span className="font-medium">$6.20</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-600">Materials:</span>
                            <span className="font-medium">$1.80</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-gray-600">Packaging:</span>
                            <span className="font-medium">$0.50</span>
                          </div>
                          <div className="flex justify-between border-t pt-2 font-medium">
                            <span>Total COGS:</span>
                            <span>$8.50</span>
                          </div>
                        </div>
                      </div>

                      {/* Financial Metrics */}
                      <div className="lg:col-span-2">
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                          <div className="text-center p-4 bg-blue-50 rounded-lg">
                            <div className="text-2xl font-bold text-blue-600">$23.99</div>
                            <div className="text-sm text-gray-600">Selling Price</div>
                          </div>
                          <div className="text-center p-4 bg-red-50 rounded-lg">
                            <div className="text-2xl font-bold text-red-600">$8.50</div>
                            <div className="text-sm text-gray-600">COGS</div>
                          </div>
                          <div className="text-center p-4 bg-green-50 rounded-lg">
                            <div className="text-2xl font-bold text-green-600">$15.49</div>
                            <div className="text-sm text-gray-600">Gross Profit</div>
                          </div>
                          <div className="text-center p-4 bg-purple-50 rounded-lg">
                            <div className="text-2xl font-bold text-purple-600">65%</div>
                            <div className="text-sm text-gray-600">Margin</div>
                          </div>
                        </div>

                        {/* Break-even Analysis */}
                        <div className="bg-gray-50 p-4 rounded-lg">
                          <h4 className="font-semibold text-gray-900 mb-3">Break-even Analysis</h4>
                          <div className="grid grid-cols-3 gap-4 text-sm">
                            <div>
                              <div className="text-gray-600">Break-even Units:</div>
                              <div className="font-bold text-gray-900">324 units</div>
                            </div>
                            <div>
                              <div className="text-gray-600">Break-even Revenue:</div>
                              <div className="font-bold text-gray-900">$7,776</div>
                            </div>
                            <div>
                              <div className="text-gray-600">Time to Break-even:</div>
                              <div className="font-bold text-gray-900">6 days</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>

              {/* PPC/ACOS Analysis */}
              <div className="mb-8">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <Target className="h-5 w-5 text-blue-600" />
                      PPC & ACOS Analysis
                    </CardTitle>
                    <CardDescription>Pay-Per-Click advertising cost analysis and optimization</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                      {/* ACOS Targets */}
                      <div>
                        <h4 className="font-semibold text-gray-900 mb-4">ACOS Target by Phase</h4>
                        <div className="space-y-3">
                          <div className="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                            <div>
                              <div className="font-medium text-red-900">Launch Phase (Weeks 1-4)</div>
                              <div className="text-sm text-red-700">Aggressive keyword targeting</div>
                            </div>
                            <div className="text-xl font-bold text-red-600">60-80%</div>
                          </div>
                          <div className="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                            <div>
                              <div className="font-medium text-yellow-900">Growth Phase (Weeks 5-12)</div>
                              <div className="text-sm text-yellow-700">Optimize and scale</div>
                            </div>
                            <div className="text-xl font-bold text-yellow-600">40-50%</div>
                          </div>
                          <div className="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div>
                              <div className="font-medium text-green-900">Mature Phase (Week 13+)</div>
                              <div className="text-sm text-green-700">Profit optimization</div>
                            </div>
                            <div className="text-xl font-bold text-green-600">25-35%</div>
                          </div>
                        </div>
                      </div>

                      {/* PPC Metrics */}
                      <div>
                        <h4 className="font-semibold text-gray-900 mb-4">Expected PPC Performance</h4>
                        <div className="space-y-4">
                          <div className="grid grid-cols-2 gap-4">
                            <div className="text-center p-3 bg-blue-50 rounded-lg">
                              <div className="text-lg font-bold text-blue-600">$1.23</div>
                              <div className="text-sm text-gray-600">Avg CPC</div>
                            </div>
                            <div className="text-center p-3 bg-purple-50 rounded-lg">
                              <div className="text-lg font-bold text-purple-600">12.5%</div>
                              <div className="text-sm text-gray-600">CVR</div>
                            </div>
                          </div>
                          
                          <div className="bg-gray-50 p-4 rounded-lg">
                            <div className="flex justify-between items-center mb-2">
                              <span className="text-sm text-gray-600">Daily Ad Spend Target:</span>
                              <span className="font-medium">$150 - $300</span>
                            </div>
                            <div className="flex justify-between items-center mb-2">
                              <span className="text-sm text-gray-600">Expected Daily Sales:</span>
                              <span className="font-medium">8-15 units</span>
                            </div>
                            <div className="flex justify-between items-center">
                              <span className="text-sm text-gray-600">ROI (after ads):</span>
                              <span className="font-medium text-green-600">180-220%</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>

              {/* Cash Flow Forecast & P&L Projections */}
              <div className="mb-8">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <TrendingUp className="h-5 w-5 text-indigo-600" />
                      Cash Flow Forecast & P&L Projections
                    </CardTitle>
                    <CardDescription>12-month financial projections and cash flow analysis</CardDescription>
                  </CardHeader>
                  <CardContent>
                    {/* Monthly P&L Table */}
                    <div className="mb-6">
                      <h4 className="font-semibold text-gray-900 mb-4">12-Month Profit & Loss Projection</h4>
                      <div className="overflow-x-auto">
                        <table className="w-full text-sm">
                          <thead>
                            <tr className="border-b bg-gray-50">
                              <th className="text-left p-2 font-medium">Month</th>
                              <th className="text-right p-2 font-medium">Units</th>
                              <th className="text-right p-2 font-medium">Revenue</th>
                              <th className="text-right p-2 font-medium">COGS</th>
                              <th className="text-right p-2 font-medium">Ad Spend</th>
                              <th className="text-right p-2 font-medium">FBA Fees</th>
                              <th className="text-right p-2 font-medium">Net Profit</th>
                            </tr>
                          </thead>
                          <tbody>
                            {[
                              { month: 'Jan', units: 1200, revenue: 28800, cogs: 10200, ads: 12000, fba: 3900, profit: 2700 },
                              { month: 'Feb', units: 1400, revenue: 33600, cogs: 11900, ads: 10080, fba: 4550, profit: 7070 },
                              { month: 'Mar', units: 1650, revenue: 39600, cogs: 14025, ads: 9900, fba: 5363, profit: 10312 },
                              { month: 'Apr', units: 1735, revenue: 41640, cogs: 14748, ads: 8328, fba: 5639, profit: 12925 },
                              { month: 'May', units: 1800, revenue: 43200, cogs: 15300, ads: 6480, fba: 5850, profit: 15570 },
                              { month: 'Jun', units: 1850, revenue: 44400, cogs: 15725, ads: 6216, fba: 6013, profit: 16446 }
                            ].map((row, index) => (
                              <tr key={index} className="border-b hover:bg-gray-50">
                                <td className="p-2 font-medium">{row.month}</td>
                                <td className="p-2 text-right">{row.units.toLocaleString()}</td>
                                <td className="p-2 text-right">${row.revenue.toLocaleString()}</td>
                                <td className="p-2 text-right">${row.cogs.toLocaleString()}</td>
                                <td className="p-2 text-right">${row.ads.toLocaleString()}</td>
                                <td className="p-2 text-right">${row.fba.toLocaleString()}</td>
                                <td className={`p-2 text-right font-medium ${row.profit > 0 ? 'text-green-600' : 'text-red-600'}`}>
                                  ${row.profit.toLocaleString()}
                                </td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                      </div>
                    </div>

                    {/* Key Financial Metrics */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                      <div className="text-center p-4 bg-blue-50 rounded-lg">
                        <div className="text-2xl font-bold text-blue-600">$484K</div>
                        <div className="text-sm text-gray-600">Annual Revenue</div>
                      </div>
                      <div className="text-center p-4 bg-green-50 rounded-lg">
                        <div className="text-2xl font-bold text-green-600">$156K</div>
                        <div className="text-sm text-gray-600">Annual Profit</div>
                      </div>
                      <div className="text-center p-4 bg-purple-50 rounded-lg">
                        <div className="text-2xl font-bold text-purple-600">32%</div>
                        <div className="text-sm text-gray-600">Profit Margin</div>
                      </div>
                      <div className="text-center p-4 bg-orange-50 rounded-lg">
                        <div className="text-2xl font-bold text-orange-600">756%</div>
                        <div className="text-sm text-gray-600">Annual ROI</div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>
          </section>
        )}

      </div>

      {/* Scroll to Top Button */}
      {showScrollTop && (
        <button
          onClick={scrollToTop}
          className="fixed bottom-8 right-8 p-4 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 transition-all transform hover:scale-110 z-50"
          aria-label="Scroll to top"
        >
          <ArrowUp className="h-5 w-5" />
        </button>
      )}

    </div>
  )
}